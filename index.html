<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>M@XCode</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-site-verification" content="zhe_jVE6TPFbrQb7K-ra2FFxgiDsn6ZeFoKSz9EXmGk" />
  <meta name="description" content="Blog dédié au partage du savoir informatique">
<meta property="og:type" content="website">
<meta property="og:title" content="M@XCode">
<meta property="og:url" content="http://maximilienandile.github.io/index.html">
<meta property="og:site_name" content="M@XCode">
<meta property="og:description" content="Blog dédié au partage du savoir informatique">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="M@XCode">
<meta name="twitter:description" content="Blog dédié au partage du savoir informatique">
  
    <link rel="alternate" href="/atom.xml" title="M@XCode" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  <link rel="stylesheet" href="/css/styles.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-77397884-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class="active"
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h3 class="blog-title">M@XCode</h3>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          
  
    <article id="post-Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/02/Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx/">Comment créer un script shell permettant de récupérer et d&#39;analyser des articles wikipedia avec lynx</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/11/02/Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx/" class="article-date"><time datetime="2016-11-02T10:15:24.000Z" itemprop="datePublished">02/11/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Qu’est-ce-qu’un-script-shell"><a href="#Qu’est-ce-qu’un-script-shell" class="headerlink" title="Qu’est ce qu’un script shell"></a>Qu’est ce qu’un script shell</h2><p>Un script “shell” est un programme écrit pour être exécuté via l’interpréteur de commande UNIX. Ces scripts sont facile à générer et suivent les patterns des langages de programmation communs. Ainsi on a la possibilité de créer des boucles et des structures conditionnelles par exemple.</p>
<p>Un script shell est dans les fait un fichier avec l’extension <strong>sh</strong>. On l’exécute en ouvrant <strong>cmd</strong> sous windows, ou le <strong>terminal</strong> sur macOS. La commande permettant d’executer un script shell est la suivante:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sh name_of_the_script.sh</div></pre></td></tr></table></figure></p>
<p>NB : Par habitude on rajoute un sigle dollar devant la commande. Il s’agit juste d’une convention permettant d’indiquer au lecteur que cette commande doit être exécutée dans le terminal.</p>
<h2 id="Iterer-sur-les-lignes-d’un-fichier-via-shell"><a href="#Iterer-sur-les-lignes-d’un-fichier-via-shell" class="headerlink" title="Itérer sur les lignes d’un fichier via shell"></a>Itérer sur les lignes d’un fichier via shell</h2><p>Afin de lire les lignes d’un fichier les unes des autres on peut utiliser la structure <code>for</code>. <code>For</code> indique à l’algorithme qu’il faut itérer pour chaque élément d’un input (ici l’ensemble des lignes de notre fichier) :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">location_of_the_url_file = &quot;./urls.txt&quot;</div><div class="line">for url in `cat  $location_of_the_url_file `</div><div class="line">&#123;</div><div class="line">  echo $url</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Dans un premier lieu on déclare la variable <code>location_of_the_url_file</code> qui stocke l’emplacement de notre fichier relativement à notre dossier de travail.</p>
<p>Dans un second temps on va récupérer l’ensemble des lignes de notre fichier via la commande :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`cat $location_of_the_url_file`</div></pre></td></tr></table></figure></p>
<h2 id="Recuperer-le-contenu-d’une-page-web-via-wget"><a href="#Recuperer-le-contenu-d’une-page-web-via-wget" class="headerlink" title="Récupérer le contenu d’une page web via wget"></a>Récupérer le contenu d’une page web via <code>wget</code></h2><p><code>wget</code> est un outil de téléchargement très puissant. On peut donc l’utiliser pour télécharger le contenu d’une page web directement depuis le terminal. Il faut d’abord bien s’assurer de l’avoir installer sur sa machine.</p>
<p>Si ce n’est pas le cas on peut utiliser la commande <code>brew install wget</code>. Homebrew est un gestionnaire de dépendance très pratique qui permet des installations rapides. Pour plus d’information voici la page : <a href="http://brew.sh/index_fr.html" target="_blank" rel="external">http://brew.sh/index_fr.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget -O ./pages/wiki.html $url</div></pre></td></tr></table></figure>
<p>La commande suivante permet de télécharger la page dont l’url est <code>$url</code> et de stocker cette dernière dans le dossier pages sous le nom <code>wiki.html</code>. Le téléchargement dans un répertoire cible est géré par la commande <code>-O</code>.</p>
<h2 id="Creer-un-dump-en-format-plain-text-de-notre-page-html-grace-a-lynx"><a href="#Creer-un-dump-en-format-plain-text-de-notre-page-html-grace-a-lynx" class="headerlink" title="Créer un dump en format plain text de notre page html grâce à lynx"></a>Créer un dump en format plain text de notre page html grâce à lynx</h2><p>Lynx est un outil permettant la manipulation de pages HTML. Il s’agit en fait d’un navigateur en mode ligne de commande. Une sorte de chrome version simplifiée.</p>
<p>Pour accéder à google depuis votre terminal :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lynx http://www.google.fr</div></pre></td></tr></table></figure>
<p><img src="images/google_version_lynx.png" alt="Google en version Lynx"></p>
<p> On peut donc produire une version <code>.txt</code> de notre page</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lynx -dump $url &gt;./plain_text/page_version_txt.txt</div></pre></td></tr></table></figure>
<p>Cette version txt de nos pages web nous permettra de nous livrer à des analyses de type “NLP” (Natural Language Processing). Nous traiterons plus en détail cet aspect dans un prochain billet.</p>
<p>Voici le code complet du programme : <a href="https://github.com/maximilienandile/shell_web_page_to_plain_text" target="_blank" rel="external">https://github.com/maximilienandile/shell_web_page_to_plain_text</a></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/11/02/Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx/" data-id="civ0u11nn0001hcmiia8hzl48" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/11/02/Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/">NLP</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/17/Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS/">Machine Learning : classification à l&#39;aide des arbres de décisions : fonctionnement et application en NodeJS</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/10/17/Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS/" class="article-date"><time datetime="2016-10-17T16:39:24.000Z" itemprop="datePublished">17/10/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Qu’est-ce-qu’un-arbre-de-decisions"><a href="#Qu’est-ce-qu’un-arbre-de-decisions" class="headerlink" title="Qu’est ce qu’un arbre de décisions"></a>Qu’est ce qu’un arbre de décisions</h2><p>Un arbre de décision est une représentation visuelle d’un algorithme de classification de données suivant différents critères qu’on appellera décisions (ou noeuds). Voici un exemple :</p>
<p><img src="/images/arbre_de_decision.png" alt="Exemple d&#39;un arbre de décision pour l&#39;accord d&#39;un prêt"></p>
<p>Cet arbre de décision permet en fonction de <strong>quelques questions de déterminer si une banque doit prêter ou pas au client</strong> qui demande un prêt. Ce dernier est très simplifié mais la plupart des banques utilisent des systèmes similaires permettant aux agents une prise de décision experte.</p>
<p>Mais comment arrive t’on à de telles règles de décisions. Dans les faits il s’agit de synthétiser la connaissance et l’historique de l’ensemble des prêts accordés par la banque et de classer chacun de ces prêts selon qu’ils aient été remboursés sans incident ou pas. <strong>Il s’agit donc de trouver dans une énorme quantité de données les questions qu’il est judicieux de poser afin de prédire la qualité d’un emprunteur.</strong></p>
<h2 id="Vocabulaire"><a href="#Vocabulaire" class="headerlink" title="Vocabulaire"></a>Vocabulaire</h2><p>Nous allons détailler la construction d’un tel arbre de décision. Posons d’abord quelques mots de vocabulaire. On va classer des objets.</p>
<ul>
<li>Chaque objet de la données historique (set d’entraînement) dispose d’une <strong>classe</strong> bien définie</li>
<li>Chaque objet (par exemple un prêt accordé à monsieur X) dispose de <strong>features</strong>, de propriétés bien définies elles aussi. Par exemple : la personne a qui on a accordé le prêt possédait-elle une maison, possédait elle un CDI ?</li>
<li>Chaque <strong>propriété</strong> ou <strong>feature</strong> a un ensemble de valeurs possibles. Par exemple (‘oui’ ou ‘non’)</li>
</ul>
<p>Dans notre graphique représentant l’arbre de décision on a les éléments suivants :</p>
<ul>
<li>Un noeud de décision (représenté par un rectangle) (on pose une question)</li>
<li>Un <strong>bloc de fin</strong> qui est représenté par un oval. (on a trouvé la classe)</li>
</ul>
<p><img src="/images/arbre_de_decision_vocabulaire.png" alt="Vocabulaire de l&#39;arbre de décision"></p>
<h2 id="Fonctionnement-de-l’algorithme-un-exemple"><a href="#Fonctionnement-de-l’algorithme-un-exemple" class="headerlink" title="Fonctionnement de l’algorithme : un exemple"></a>Fonctionnement de l’algorithme : un exemple</h2><p>Dans les faits on aura en entrée de notre algorithme une série de données qui représentera de nombreux <strong>objets</strong> (ici des prêts) ayant chacun un set de <strong>propriétés</strong> (ici : CDI oui ou Non, Locataire oui ou non …). Ces objets du set d’entrainement seront déjà <strong>classés</strong> (ex: Bon Emprunteur).Par exemple :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Prêt 1 : CDI : 1 - Locataire : 1 - Classe : Bon emprunteur</div><div class="line">Prêt 2 : CDI : 0 - Locataire : 0 - Classe : Bon emprunteur</div><div class="line">Prêt 3 : CDI : 1 - Locataire : 1 - Classe : Bon emprunteur</div><div class="line">Prêt 4 : CDI : 0 - Locataire : 0 - Classe : Mauvais emprunteur</div><div class="line">Prêt 5 : CDI : 1 - Locataire : 1 - Classe : Bon emprunteur</div><div class="line">...</div></pre></td></tr></table></figure>
<p>Notre algorithme va donc devoir choisir une première question à poser à notre candidat. Pour cela il doit choisir la <strong>feature</strong> (ou propriété) qui permet de découper nos prêts en <strong>deux sets les plus homogènes possibles</strong>, c’est à dire deux sets regroupant des prêts dont les emprunteurs sont en grande partie d’une même catégorie.</p>
<p>Par exemple l’algorithme va tester la <strong>feature CDI</strong> et va ensuite répartir les prêts dans deux set : les prêts fait par des personnes en CDI et les autres. Si dans un des set on trouve que des prêts ayant la même classe alors <strong>l’algorithme s’arrêtera pour cette branche</strong>. Par exemple si on constate que tous les gens qui n’ont pas de CDI sont des mauvais emprunteurs alors on peut s’arrêter là et dire à nos agents de ne plus prêter aux gens sans CDI.</p>
<p>Si on a pas obtenu un set composé de prêts qui ont la même classe après ce premier split, on va ensuite refaire le même travail pour les features suivantes. Nous allons sélectionner la feature permettant un classement le plus homogène possible… <strong>Ce processus est mené jusqu’à ce qu’o obtiennent des classes homogènes.</strong></p>
<h2 id="Overfitting-et-extraction-de-sens"><a href="#Overfitting-et-extraction-de-sens" class="headerlink" title="Overfitting et extraction de sens"></a>Overfitting et extraction de sens</h2><p>Cet algorithme est peu gourmand en mémoire. Mais il y a un risque très important d’<strong>overfitting</strong>, c’est à dire que l’arbre n’est pas utilisable car il fournit des résultats très bon pour le set d’entraînement, mais utilisé en conditions réelles il classe très mal les nouveaux exemples. Pour cela on peut envisager d’avoir couper notre set d’entrainement en deux afin d’avoir un set de données permettant de valider si il y a <strong>overfitting</strong> ou pas.</p>
<p>Cet algorithme est <strong>très intéressant pour extraire de l’information d’une source de données obscure</strong>. Il permet d’<strong>isoler les propriétés</strong> ou features qui apportent le plus d’information pour <strong>déterminer la classe de chaque objet</strong>.</p>
<h2 id="Application-en-NodeJS"><a href="#Application-en-NodeJS" class="headerlink" title="Application en NodeJS"></a>Application en NodeJS</h2><h3 id="Calcul-de-l’entropie-de-Shannon"><a href="#Calcul-de-l’entropie-de-Shannon" class="headerlink" title="Calcul de l’entropie de Shannon"></a>Calcul de l’entropie de Shannon</h3><p>Dans le paragraphe précédent nous disions qu’il fallait trouver la feature générant des classes qui sont les plus homogènes possibles. Mais comment définir cette <strong>homogénéité</strong> ?</p>
<p>Nous allons utiliser un résultat important de la <strong>théorie mathématique de l’information</strong> : l’entropie. Et plus particulièrement l’entropie de <strong>Shannon</strong> :</p>
<center><br><span>$H=-\sum_{i=1}^{n} P(x_{i})log_{2}(P(x_{i}) )$</span><!-- Has MathJax --><br></center>

<p><strong>L’entropie correspond au désordre</strong>. Plus on a de classes différentes dans un set de données plus l’entropie sera grande. De manière opposée si dans un set de données tous les objets ont la même classe, il n’y aura <strong>pas de désordre l’entropie sera nulle</strong>.</p>
<p>Dans les faits on va calculer l’entropie de la manière suivante en NodeJS :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>);</div><div class="line"><span class="comment">/**</span></div><div class="line">* This function is used to compute the Shannon Entropy</div><div class="line">* @method calculate_shannon_entropy</div><div class="line">* @param  &#123;Array&#125;                  data an array of data</div><div class="line">* @return &#123;Number&#125;                       The Shannon Entropy</div><div class="line">*/</div><div class="line"><span class="keyword">var</span> calculate_shannon_entropy=<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// init the shannon Entropy</span></div><div class="line">  <span class="keyword">var</span> shannon_entropy = <span class="number">0</span>;</div><div class="line">  <span class="comment">// we get the number of entries in the array</span></div><div class="line">  <span class="keyword">var</span> length_of_data = data.length;</div><div class="line">  <span class="comment">// create an empty array to keep track of different labels</span></div><div class="line">  <span class="keyword">var</span> labels_counter = &#123;&#125;</div><div class="line">  <span class="comment">// we iterate through the array</span></div><div class="line">  _.forEach(data, <span class="function"><span class="keyword">function</span>(<span class="params">value, key</span>) </span>&#123;</div><div class="line">    <span class="comment">// extract the label from the one data element</span></div><div class="line">    <span class="keyword">var</span> label_extracted = value.label;</div><div class="line">    <span class="comment">// check if this label is inside our label counter array</span></div><div class="line">    <span class="keyword">if</span> (label_extracted <span class="keyword">in</span> labels_counter)&#123;</div><div class="line">      <span class="comment">// the element is inside our object increment its value</span></div><div class="line">      labels_counter[label_extracted] +=<span class="number">1</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      labels_counter[label_extracted] = <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// We then iterate through our label counter object</span></div><div class="line">  _.forEach(labels_counter, <span class="function"><span class="keyword">function</span>(<span class="params">value, key</span>) </span>&#123;</div><div class="line">    <span class="comment">// we get the frequency of the number of time a label occurs</span></div><div class="line">    <span class="keyword">var</span> p = <span class="built_in">parseFloat</span>(value/length_of_data)</div><div class="line">    <span class="comment">// Caculate the entropy of a class and add it to the shannon_entropy variable</span></div><div class="line">    shannon_entropy -= p * getBaseLog(<span class="number">2</span>,p)</div><div class="line"></div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> shannon_entropy</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* This function return the log of Y in base X</div><div class="line">* @method getBaseLog</div><div class="line">* @param  &#123;Number&#125;   x base</div><div class="line">* @param  &#123;Number&#125;   y number</div><div class="line">* @return &#123;Number&#125;     the log of Y in base X</div><div class="line">*/</div><div class="line"><span class="keyword">var</span> getBaseLog=<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.log(y) / <span class="built_in">Math</span>.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = [</div><div class="line">  &#123;<span class="string">"has_a_car"</span>:<span class="number">1</span>, <span class="string">"has_a_house"</span>:<span class="number">1</span>, <span class="string">"has_children"</span>:<span class="number">1</span>,<span class="string">"label"</span>:<span class="string">"bon_emprunteur"</span>&#125;,</div><div class="line">  &#123;<span class="string">"has_a_car"</span>:<span class="number">1</span>, <span class="string">"has_a_house"</span>:<span class="number">1</span>, <span class="string">"has_children"</span>:<span class="number">0</span>,<span class="string">"label"</span>:<span class="string">"bon_emprunteur"</span>&#125;,</div><div class="line">  &#123;<span class="string">"has_a_car"</span>:<span class="number">1</span>, <span class="string">"has_a_house"</span>:<span class="number">0</span>, <span class="string">"has_children"</span>:<span class="number">1</span>,<span class="string">"label"</span>:<span class="string">"bon_emprunteur"</span>&#125;,</div><div class="line">  &#123;<span class="string">"has_a_car"</span>:<span class="number">0</span>, <span class="string">"has_a_house"</span>:<span class="number">0</span>, <span class="string">"has_children"</span>:<span class="number">0</span>,<span class="string">"label"</span>:<span class="string">"mauvais_emprunteur"</span>&#125;,</div><div class="line">  &#123;<span class="string">"has_a_car"</span>:<span class="number">0</span>, <span class="string">"has_a_house"</span>:<span class="number">0</span>, <span class="string">"has_children"</span>:<span class="number">1</span>,<span class="string">"label"</span>:<span class="string">"mauvais_emprunteur"</span>&#125;</div><div class="line">]</div><div class="line">calculate_shannon_entropy(a)</div><div class="line"><span class="comment">// returns 0.9709505944546686</span></div></pre></td></tr></table></figure>
<p>On prend donc la fréquence d’apparition de la classe <code>bon_emprunteur</code> et son log en base 2 auquel on va ajouter moins la fréquence d’apparition de la classe <code>mauvais_emprunteur</code> et son log en base 2 !</p>
<p>Il va falloir ensuite que l’on puisse éliminer des features au fur et à mesure que l’on split notre données au fil des blocs de décision. C’est l’objet de la partie suivante :</p>
<h3 id="Creation-de-la-fonction-permettant-de-partitionner-un-set-de-donnees-en-fonction-d’une-feature-et-de-sa-valeur"><a href="#Creation-de-la-fonction-permettant-de-partitionner-un-set-de-donnees-en-fonction-d’une-feature-et-de-sa-valeur" class="headerlink" title="Création de la fonction permettant de partitionner un set de données en fonction d’une feature et de sa valeur"></a>Création de la fonction permettant de partitionner un set de données en fonction d’une feature et de sa valeur</h3><p>Notre mission ensuite est de préparer la fonction qui permet à partir d’un set de données d’entrainement de récupérer un set plus petit ne contenant plus que les objets disposant de cette feature dont la valeur est égale à une des valeurs possibles de la feature.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* This function split our dataset and extract object that have the feature set to a specific value</div><div class="line">* @method split_the_dataset_by_feature_and_value</div><div class="line">* @param  &#123;Array of Object&#125;                               data    our dataset</div><div class="line">* @param  &#123;String&#125;                               feature the name of the feature</div><div class="line">* @param  &#123;String or Number&#125;                               value   the value of the feature to extract from the dataset</div><div class="line">* @return  &#123;Array of Object&#125;                               value   the dataset without the objects that have the feature "feature" set to the value "value" &amp; without the feature "feature"</div><div class="line">*/</div><div class="line"><span class="keyword">var</span> split_the_dataset_by_feature_and_value=<span class="function"><span class="keyword">function</span>(<span class="params">data_set,feature,value</span>)</span>&#123;</div><div class="line">  <span class="comment">// we partition our array in order to isolate in the data</span></div><div class="line">  <span class="comment">// Objects that have the `feature` set to the right value</span></div><div class="line">  <span class="keyword">var</span> data_set</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">var</span> array_partitioned = _.filter(data_set, <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123; <span class="keyword">return</span> o[feature]==value; &#125;);</div><div class="line">  <span class="comment">// we then have to remove the feature from our objects</span></div><div class="line">  <span class="keyword">var</span> array_to_return = []</div><div class="line"></div><div class="line"></div><div class="line">  array_partitioned.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> new_object = &#123;&#125;</div><div class="line">    _.forEach(v, <span class="function"><span class="keyword">function</span>(<span class="params">value, key</span>) </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(key!==feature)&#123;</div><div class="line">          new_object[key]=value</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    array_to_return.push(new_object)</div><div class="line"></div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> array_to_return</div><div class="line">&#125;</div><div class="line"></div><div class="line">split_the_dataset_by_feature_and_value(a,<span class="string">"has_a_house"</span>,<span class="number">0</span>)</div><div class="line"><span class="comment">// returns</span></div><div class="line"><span class="comment">// [ &#123; has_a_car: 1, has_children: 1, label: 'bon_emprunteur' &#125;,</span></div><div class="line"><span class="comment">//  &#123; has_a_car: 0, has_children: 0, label: 'mauvais_emprunteur' &#125;,</span></div><div class="line"><span class="comment">//  &#123; has_a_car: 0, has_children: 1, label: 'mauvais_emprunteur' &#125; ]</span></div></pre></td></tr></table></figure>
<p>Par exemple ici nous nous débarassons des objets dans notre set de données dont la feature <code>has_a_house</code> est différent de 0.</p>
<p>Maintenant attaquons nous au coeur du réacteur : nous devons trouver la meilleur feature, autrement dit celle qui génère le moins d’entropie (on parle aussi de <strong>gain informationnel maximal</strong>)…</p>
<h3 id="Determiner-la-feature-dans-un-set-de-donnees-generant-un-gain-informationnel-maximal"><a href="#Determiner-la-feature-dans-un-set-de-donnees-generant-un-gain-informationnel-maximal" class="headerlink" title="Déterminer la feature dans un set de données générant un gain informationnel maximal"></a>Déterminer la feature dans un set de données générant un gain informationnel maximal</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>);</div><div class="line"><span class="keyword">var</span> data_set_splitter = <span class="built_in">require</span>(<span class="string">'./data_set_splitter'</span>)</div><div class="line"><span class="keyword">var</span> shannon_entropy = <span class="built_in">require</span>(<span class="string">'./shannon_entropy'</span>)</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">* This function will select the best feature for splittingwith the help</div><div class="line">* of the shannon entropy</div><div class="line">* @method get_the_best_feature_for_splitting</div><div class="line">* @param  &#123;Array&#125;                           data  A dataset of training, an array conposed of object with a property "label" that represents the class</div><div class="line">* @return &#123;String&#125;                                The name of the best feature for splitting (the property name)</div><div class="line">*/</div><div class="line"><span class="keyword">var</span>  get_the_best_feature_for_splitting= <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  <span class="comment">// we compute the Entropy</span></div><div class="line">  <span class="keyword">var</span> base_entropy_value = shannon_entropy.calculate_shannon_entropy(data)</div><div class="line">  <span class="comment">// init a variable that will contain the best informational gain value</span></div><div class="line">  <span class="keyword">var</span> best_informational_gain_value = <span class="number">0</span></div><div class="line">  <span class="comment">// init a variable that will contain the best feature choice for splitting</span></div><div class="line">  <span class="keyword">var</span> best_feature_name = <span class="string">""</span></div><div class="line">  <span class="comment">// we iterate through our features (we take the first data element)</span></div><div class="line">  _.forEach(data[<span class="number">0</span>], <span class="function"><span class="keyword">function</span>(<span class="params">value_of_feature, feature_name</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(feature_name != <span class="string">"label"</span>)&#123;</div><div class="line"></div><div class="line"></div><div class="line">      <span class="comment">// get the unique values of each feature</span></div><div class="line">      <span class="keyword">var</span> unique_values_of_this_feature = _.uniq(_.map(data, feature_name));</div><div class="line">      <span class="comment">// init a variable that will contain the new_entropy_value</span></div><div class="line">      <span class="keyword">var</span> new_entropy_value = <span class="number">0</span>;</div><div class="line">      <span class="comment">// iterate through each possible value of this feature</span></div><div class="line">      _.forEach(unique_values_of_this_feature, <span class="function"><span class="keyword">function</span>(<span class="params">value_of_this_feature, key</span>) </span>&#123;</div><div class="line"></div><div class="line">        <span class="keyword">var</span>  data_set_without_this_feature_of_value = data_set_splitter.split_the_dataset_by_feature_and_value(data,feature_name,value_of_this_feature)</div><div class="line"></div><div class="line">        <span class="keyword">var</span> p = <span class="built_in">parseFloat</span>(data_set_without_this_feature_of_value.length/data.length)</div><div class="line">        new_entropy_value += p*shannon_entropy.calculate_shannon_entropy(data_set_without_this_feature_of_value)</div><div class="line"></div><div class="line">      &#125;)</div><div class="line"></div><div class="line">      <span class="comment">// we can now have the informational gain for this specific feature</span></div><div class="line">      <span class="keyword">var</span> informational_gain_value = base_entropy_value - new_entropy_value</div><div class="line">      <span class="comment">// if the informational gain value is higher than the best one</span></div><div class="line">      <span class="keyword">if</span>(informational_gain_value &gt; best_informational_gain_value)&#123;</div><div class="line">        <span class="comment">// it now become the best informational gain</span></div><div class="line">        best_informational_gain_value = informational_gain_value</div><div class="line">        <span class="comment">// and the best feature has to be keep in memory</span></div><div class="line">        best_feature_name = feature_name</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">return</span> best_feature_name;</div><div class="line">&#125;</div><div class="line"></div><div class="line">get_the_best_feature_for_splitting(a)</div><div class="line"><span class="comment">// returns "has_a_car"</span></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">get_the_best_feature_for_splitting</span>:get_the_best_feature_for_splitting</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Cette fonction doit détecter quelle est la feature qui apporte un gain informationnel maximal. Nous cherchons en effet à trouver la feature permettant de diviser nos exemples dans des “compartiments”, “compartiments” qui doivent avoir la particularité de regrouper des exemples de classes similaires, et ce dans une proportion la plus importante possible. Ainsi nous <code>réduisons le désordre</code>.</p>
<p>Dans les faits nous allons faire usage du calcul de l’entropie de Shannon pour calculer cette notion de différentiel de <code>désordre</code>.<br>Si on prend l’exemple de la feature <code>has_a_car</code>, on a donc deux valeurs possibles : <code>vrai</code> ou <code>faux</code>. Première étape : l’algorithme va donc générer un set de données ne contenant pas les exemples dont la <code>has_a_car</code> vaut <code>vrai</code>. On calcule ensuite le rapport entre le nombre d’éléments de notre nouveau set de données et le nombre d’élément que contient le set de données d’origine. On calcule ensuite l’entropie avec ce nouveau jeu de données. Ce processus est <strong>répété</strong> pour chaque valeur de la feature (donc 2 fois ici). On calcule ensuite pour chacune des feature le <code>gain informationnel</code>.</p>
<p>Ce dernier étant défini comme la différence entre l’entropie de base et la somme des entropies (pour chaque valeur de la feature). L’algorithme sélectionnera la feature qui permet d’obtenir le <strong>meilleur gain informationnel</strong> !</p>
<h3 id="Construction-de-l’arbre-de-decisions-de-maniere-recursive"><a href="#Construction-de-l’arbre-de-decisions-de-maniere-recursive" class="headerlink" title="Construction de l’arbre de décisions de manière récursive"></a>Construction de l’arbre de décisions de manière récursive</h3><p>Il est temps de construire notre arbre. Nous allons le faire grâce à l’usage d’une <strong>fonction récursive</strong>, c’est à dire une fonction qui va elle même s’appeler au cours de son exécution. Pour plus d’informations sur la récursivité rendez-vous sur la page wikipédia : <a href="https://fr.wikipedia.org/wiki/Fonction_r%C3%A9cursive" target="_blank" rel="external">https://fr.wikipedia.org/wiki/Fonction_r%C3%A9cursive</a>.</p>
<p>Lorsqu’on bâtit une fonction récursive il faut en premier lieu visualiser nos conditions de sorties. Nous allons donc itérer sur notre jeu de données d’entrainement afin à chaque fois de détecter la meilleur feature permettant de diviser notre jeu de données. Ainsi à chaque itération <strong>on isole la meilleure feature</strong>, on débarasse notre jeu de données de cette dernière. Cette meilleure feature sera donc une feuille de notre arbre. De cette feuille on aura autant de ramifications que de valeurs possibles à cette feature. Chaque feuille sera ensuite générée de suivant le même algorithme. Les conditions de sorties seront donc au nombre de deux :</p>
<ul>
<li>Il ne reste plus de features dans le jeu de données</li>
<li>Il ne reste plus que des objets ayant tous la même classe.</li>
</ul>
<p>Voici l’algorithme :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>);</div><div class="line"><span class="keyword">var</span> data_set_splitter = <span class="built_in">require</span>(<span class="string">'./data_set_splitter'</span>)</div><div class="line"><span class="keyword">var</span> best_feature_selector = <span class="built_in">require</span>(<span class="string">'./best_feature_selector'</span>)</div><div class="line"><span class="keyword">var</span> shannon_entropy = <span class="built_in">require</span>(<span class="string">'./shannon_entropy'</span>)</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * This method will generate a decision tree</div><div class="line"> * @method generate_decision_tree</div><div class="line"> * @param  &#123;Array of object&#125;               data The dataset</div><div class="line"> * @return &#123;Object&#125;                    The decision tree/ ex : &#123;"has_a_car":&#123;"yes":&#123;"has_a_house":&#123;"yes":"good_borrower","no":"bad_borrower"&#125;&#125;,"no":"bad_borrower"&#125;&#125;</div><div class="line"> */</div><div class="line"><span class="keyword">var</span> generate_decision_tree = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// Because we build a recursive function</span></div><div class="line">  <span class="comment">// we have to set our stopping conditions at the</span></div><div class="line">  <span class="comment">// top.</span></div><div class="line"></div><div class="line">  <span class="comment">// group the dataset by label</span></div><div class="line">  <span class="keyword">var</span> grouped_data_per_label = _.groupBy(data, <span class="function"><span class="keyword">function</span>(<span class="params">o</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> o.label</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// We stop when there are only elements of the same class</span></div><div class="line">  <span class="comment">// inside the dataset</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="keyword">if</span>(_.size(grouped_data_per_label)===<span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(grouped_data_per_label)[<span class="number">0</span>]</div><div class="line">  &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">//  If there is no more features to split</span></div><div class="line">  <span class="comment">//  The size of the first training is only 1 because</span></div><div class="line">  <span class="comment">//  there is just one property the class</span></div><div class="line">  <span class="comment">//  ex : data[0] = &#123;"label":"good_borrower"&#125;</span></div><div class="line">  <span class="keyword">if</span>(_.size(data[<span class="number">0</span>])===<span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">return</span> mostly_present_class(data)</div><div class="line">  &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  <span class="comment">// Get the best feature to split</span></div><div class="line">  <span class="keyword">var</span> best_feature_for_splitting = best_feature_selector.get_the_best_feature_for_splitting(data)</div><div class="line"></div><div class="line">  <span class="comment">// create the object decision tree</span></div><div class="line">  <span class="keyword">var</span> decision_tree =&#123;&#125;</div><div class="line">  decision_tree[best_feature_for_splitting]=&#123;&#125;</div><div class="line"></div><div class="line">  <span class="comment">// we have then to extract the unique values of this feature in the dataset</span></div><div class="line">  <span class="comment">// get unique values of this feature</span></div><div class="line">  <span class="keyword">var</span> unique_values_of_best_feature =  _.uniq(_.map(data, best_feature_for_splitting));</div><div class="line">  <span class="comment">// forEach unique values of this feature</span></div><div class="line">  _.map(unique_values_of_best_feature, <span class="function"><span class="keyword">function</span>(<span class="params">value_of_this_feature</span>) </span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// We get the dataset cleaned of examples that have a feature "best_feature_for_splitting"</span></div><div class="line">    <span class="comment">// set to the value : "value_of_this_feature"</span></div><div class="line">    <span class="keyword">var</span> new_data_set = data_set_splitter.split_the_dataset_by_feature_and_value(data,best_feature_for_splitting,value_of_this_feature)</div><div class="line">    decision_tree[best_feature_for_splitting][value_of_this_feature] = generate_decision_tree(new_data_set);</div><div class="line"></div><div class="line">  &#125;);</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">return</span> decision_tree</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports=&#123;</div><div class="line">  <span class="attr">generate_decision_tree</span> : generate_decision_tree</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>On obtient donc le résultat suivant pour notre set de données d’exemple :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&quot;has_a_car&quot;:&#123;&quot;yes&quot;:&#123;&quot;has_a_house&quot;:&#123;&quot;yes&quot;:&quot;good_borrower&quot;,&quot;no&quot;:&quot;bad_borrower&quot;&#125;&#125;,&quot;no&quot;:&quot;bad_borrower&quot;&#125;&#125;</div></pre></td></tr></table></figure>
<p>L’ensemble du code se trouve sur mon repo github : <a href="https://github.com/maximilienandile/decision_tree_example" target="_blank" rel="external">https://github.com/maximilienandile/decision_tree_example</a></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/10/17/Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS/" data-id="civ0u11o9000nhcmi9avv6ysb" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/10/17/Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      

    </footer>
  </div>
  
</article>



  
    <article id="post-Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/12/Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel/">Base de données : comprendre les différences entre le modèle relationnel et le modèle multidimensionnel</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/10/12/Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel/" class="article-date"><time datetime="2016-10-12T09:20:09.000Z" itemprop="datePublished">12/10/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Le-modele-relationnel-est-dominant"><a href="#Le-modele-relationnel-est-dominant" class="headerlink" title="Le modèle relationnel est dominant"></a>Le modèle relationnel est dominant</h2><p>Lorsqu’on est amené à construire une application web on utilise en général le modèle relationnel (cette question ne se pose pas toutefois si on travaille avec une base de données de type <strong>NoSQL</strong>, comme MongoDB, Couchbase …). Nous utilisons tous finalement le <strong>modèle relationnel</strong> sans forcément en avoir conscience. Sa manière de fonctionner étant relativement naturelle. D’ailleurs si nous revenons une étape avant, on peut légitimement s’interroger sur ce qu’est un <strong>modèle</strong> de base de données… Il s’agit simplement de <strong>règles de construction et d’utilisation d’une base de données</strong>. Un modèle est en général très <strong>normé</strong> afin que l’architecture d’une base reste compréhensible même en cas de changement d’équipe.</p>
<p>Les bases de données avec des modèles relationnels sont encore largement utilisées :</p>
<p><img src="img/repartition_usage_databases_octobre_2016.png" alt="Répartition de l&#39;utilisation des SGBD(Système de gestion de bases de données) en Octobre 2016, http://db-engines.com/en/ranking "></p>
<h2 id="Caracteristiques-du-modele-relationnel"><a href="#Caracteristiques-du-modele-relationnel" class="headerlink" title="Caractéristiques du modèle relationnel"></a>Caractéristiques du modèle relationnel</h2><p>Modéliser une donnée de façon relationnel revient à penser les données de son application sous forme d’une <strong>multitude d’objets</strong> qui disposent de <strong>relations</strong> permettant de les <strong>lier</strong> ensemble. La modélisation de la base de données amène à la génération d’un <strong>schéma</strong> de la base de données. Cette définition semble abstraite, prenons un exemple pour mieux la comprendre : le commerce électronique.</p>
<p>Pour un site e-commerce nous avons plusieurs <strong>objets</strong> : des clients, des commandes, des adresses, des produits, des fabricants. Ces objets disposent d’une multitude de liens entre eux. Par exemple un client dispose de plusieurs adresses, une commande de produits, un client de commandes …  On voit aussi que si certains objets ont des relations multiples avec d’autres, on a aussi des relations uniques entre certains objets. Un produit à par exemple un seul et unique fabricant. Il ne peut en avoir deux…</p>
<h3 id="Les-differents-types-de-relations"><a href="#Les-differents-types-de-relations" class="headerlink" title="Les différents types de relations"></a>Les différents types de relations</h3><p>Ainsi les liens entre les objets sont de différents types :</p>
<ul>
<li><strong>1-n</strong> : ou encore relations <strong>un à plusieurs</strong> par exemple entre l’objet client et l’objet commande : un client peut avoir plusieurs commandes, mais une commande ne peut avoir qu’un seul client.</li>
<li><strong>n-n</strong> : ou encore relations <strong>plusieurs à plusieurs</strong> : un produit peut avoir plusieurs couleurs et une couleur n’est pas spécifique à un produit. Il peut y avoir plus d’un produit de couleur X.</li>
<li><strong>1-1</strong> : ou encore les relations <strong>un à un</strong> par exemple si nous stockions les numéros de carte d’identité de nos clients. Un client ne peux avoir qu’un seul numéro de CNI et un numéro de CNI correspond à un unique client. Ce type de relation est toutefois extrêmement rare.</li>
</ul>
<h3 id="Tables-et-objets"><a href="#Tables-et-objets" class="headerlink" title="Tables et objets"></a>Tables et objets</h3><p>Chaque famille d’objet est stocké dans une <strong>table</strong>. On a ainsi une table <code>client</code>, une table <code>commande</code>…</p>
<p>Chaque objet <code>client</code> dispose d’un clé <strong>primaire</strong>. Cette clé est un identifiant unique <strong>d’un objet particulier stocké dans la table</strong>. Cette clé unique permet ensuite de lier l’objet en question à un autre objet cible (par exemple une <code>commande</code>). Dans la table des <code>commandes</code> on trouvera une clé primaire (qui permet d’identifier formellement la commande), mais aussi une <strong>clé étrangère</strong> <code>client</code> qui permet de <strong>lier cette commande à un client</strong>.</p>
<h2 id="Limites-du-modele-relationnel"><a href="#Limites-du-modele-relationnel" class="headerlink" title="Limites du modèle relationnel"></a>Limites du modèle relationnel</h2><p>Le type de modélisation relationnel est particulièrement efficace pour traiter les données provenant d’applications transactionnelles. Par exemple pour un site e-commerce l’utilisation d’une modélisation relationnelle est bien adapté. On parle de systèmes de type OLTP (OnLine Transaction Processing). Un système de facturation client est ainsi assez aisé à créer dans le cadre du paradigme relationnel : on aura la table client, la table facture, la table des acomptes…etc chacune étant reliée grâce aux clés primaires (d’un côté) et étrangères (de l’autre).</p>
<h2 id="Le-modele-multidimensionnel-des-requetes-analytiques-performantes-et-plus-facile-a-ecrire"><a href="#Le-modele-multidimensionnel-des-requetes-analytiques-performantes-et-plus-facile-a-ecrire" class="headerlink" title="Le modèle multidimensionnel : des requêtes analytiques performantes et plus facile à écrire"></a>Le modèle multidimensionnel : des requêtes analytiques performantes et plus facile à écrire</h2><p>Mais pourquoi donc aurait-on besoin d’ajouter un autre schéma ? La réponse est simple lorsque les bases relationnelles commencent à accumuler un volume de données important le temps nécessaires aux requêtes analytiques augmente significativement. Précisons bien d’emblé que seules les <strong>requêtes analytiques</strong> sont concernées. Par exemple voiloir calculer un taux de rétention sur une table regroupant l’ensemble des activités des utilisateurs peut s’avérer très <strong>couteux en temps de calcul</strong>.</p>
<p>Le modèle multidimensionnel permet aussi de <strong>réduire la difficulté d’écriture des requêtes</strong> qui dans le cadre des bases classiques peuvent vite devenir illisible. Et qui dit illisible, dit temps perdu par le développeur ! Ainsi <strong>on peut interroger plus facilement ces modèles tout en ayant des temps de réponses bien meilleurs</strong>.</p>
<h3 id="Comparaison-des-requetes-SQL-amp-MDX"><a href="#Comparaison-des-requetes-SQL-amp-MDX" class="headerlink" title="Comparaison des requêtes SQL &amp; MDX"></a>Comparaison des requêtes SQL &amp; MDX</h3><p>Par exemple dans le cas d’un modèle relationnel (en supposant un schéma permettant cette requête); pour avoir le nombre distinct de commandes d’un produit de la catégorie <code>X</code> par client on pourrait avoir une requête comme suis :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> c.first_name , c.last_name, <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> o.id)</div><div class="line"><span class="keyword">FROM</span></div><div class="line">order_detail od</div><div class="line"><span class="comment">-- Obtention de l'information produit à partir de la table order detail</span></div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> product p <span class="keyword">ON</span> od.product_id = p.id</div><div class="line"><span class="comment">-- Obtention de la catégorie</span></div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">category</span> c <span class="keyword">ON</span> p.category_id = c.id</div><div class="line"><span class="comment">-- Obtention de la commande pour avoir le client</span></div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">order</span> o <span class="keyword">ON</span> od.order_id = o.id</div><div class="line"><span class="comment">-- Obtention de la données client (pour pouvoir afficher la data par client)</span></div><div class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">client</span> c <span class="keyword">ON</span> o.client_id = c.id</div><div class="line"><span class="comment">-- Nous ne souhaitons que les produits d'id X</span></div><div class="line"><span class="keyword">WHERE</span> c.name = <span class="string">'X'</span></div><div class="line"><span class="comment">-- On groupe les résultats par client</span></div><div class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.first_name+<span class="string">' '</span>+c.last_name</div></pre></td></tr></table></figure>
<p>On est obligé de faire une jointure sur plusieurs tables et <strong>la requête devient assez longue et peu élégante</strong>, de suite elle est plus complexe à débugger. Tandis qu’on aura une version plus courte de la requête avec l’aide du <code>MDX</code> (un simili SQL qui permet d’interroger des bases multidimensionnelles de manière plus simple) :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> [<span class="keyword">Measures</span>].[Orders <span class="keyword">Count</span>] <span class="keyword">ON</span> <span class="keyword">COLUMNS</span>,</div><div class="line">[Customer].[Customer].Members <span class="keyword">ON</span> <span class="keyword">ROWS</span></div><div class="line"><span class="keyword">FROM</span> [<span class="keyword">Data</span> Warehouse <span class="keyword">project</span>]</div><div class="line"><span class="keyword">WHERE</span> [Product].[Product Categories].[<span class="keyword">Category</span>].[X]</div></pre></td></tr></table></figure>
<p>Beaucoup plus simple et lisible !</p>
<h2 id="Dimensions-faits-et-mesures-le-modele-en-etoile"><a href="#Dimensions-faits-et-mesures-le-modele-en-etoile" class="headerlink" title="Dimensions, faits et mesures : le modèle en étoile"></a>Dimensions, faits et mesures : le modèle en étoile</h2><p>Voici un modèle d’organisation multidimensionnel (aussi appelé OLAP) :</p>
<p><img src="img/star_schema_presentation.png" alt="Le modèle multidimensionnel en étoile (star schema)"></p>
<p>On voit donc qu’<strong>on organise la données en pensant d’abord aux analyses</strong> qui vont y être faite. Ici on veut pouvoir comprendre la répartition du profit et du revenu net en fonction du produit, du client, de la catégorie, du code postal de livraison, de la méthode de livraison ! On va donc créer nos dimensions d’analyse : on aura donc 5 dimensions. Ce qui se manifestera dans le schéma par <strong>5 tables de dimensions</strong>.</p>
<p>A ces 5 tables de dimensions on ajoute une table centrale, qui est la <strong>table de fait</strong> (<code>fact table</code>). Cette table de fait va regrouper les clés étrangères des tables de dimensions (<code>ID_client</code>, <code>ID_product</code>, …) mais aussi nos <code>mesures</code>(ou <strong>metrics</strong>) : ici le profit, le revenu net et la TVA.</p>
<p>On voit donc bien maintenant pourquoi il s’agit d’un <strong>modèle en étoile</strong>. Les dimensions ne sont pas liées entre elles et c’est la table de fait qui fait le lien entre les mesures et l’ensemble des dimensions !</p>
<h2 id="Les-metiers-peuvent-interroger-directement-les-bases"><a href="#Les-metiers-peuvent-interroger-directement-les-bases" class="headerlink" title="Les métiers peuvent interroger directement les bases !"></a>Les métiers peuvent interroger directement les bases !</h2><p>Par la suite on peut donner la possibilité au métier d’interroger directement la base afin de faire des analyses à volonté à partir de ces dimensions. De nombreuses solutions d’interrogations existent. L’une de mes préférée est <strong>Saiku</strong> (<a href="http://www.meteorite.bi/" target="_blank" rel="external">http://www.meteorite.bi/</a>) qui dispose d’une version open source ! Les métiers peuvent générer des tableaux à la volée en couplant les dimensions, sans avoir à maitriser le MDX !</p>
<p>Le modèle dispose encore de bien d’autres avantages et caractéristiques, j’essayerai ‘écrire à nouveau sur ce sujet passionnant.</p>
<p>Lectures :</p>
<ul>
<li><a href="http://www.joyofdata.de/" target="_blank" rel="external">http://www.joyofdata.de/</a> : un blog passionnant sur la BI</li>
<li><a href="http://pentaho-bi-suite.blogspot.fr/" target="_blank" rel="external">http://pentaho-bi-suite.blogspot.fr/</a> : un autre blog plus orienté Pentaho, mais tout aussi intéressant à suivre.</li>
</ul>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/10/12/Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel/" data-id="civ0u11o0000ahcmi56ok4ekz" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/10/12/Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Business-Intelligence/">Business Intelligence</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/01/Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement/">Comment installer PHPUnit sur un projet nécessitant composer et utilisant des variables d&#39;environnement</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/10/01/Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement/" class="article-date"><time datetime="2016-10-01T14:13:20.000Z" itemprop="datePublished">01/10/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Installation-de-PHPUnit-macOS"><a href="#Installation-de-PHPUnit-macOS" class="headerlink" title="Installation de PHPUnit (macOS)"></a>Installation de PHPUnit (macOS)</h2><p>Afin d’installer PHPUnit nous allons devoir ouvrir le terminal  et taper les commandes suivantes :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ curl https://phar.phpunit.de/phpunit.phar -L -o phpunit.phar</div><div class="line">$ chmod +x phpunit.phar</div><div class="line">$ mv phpunit.phar /usr/local/bin/phpunit</div></pre></td></tr></table></figure>
<p>Ces commandes permettent de télécharger le fichier <code>.phar</code>. (Un fichier <code>.PHAR</code> est une PHP Archive, une application PHP compactée dans un seul et même fichier). Elles permettent ensuite d’étendre le niveau des droits sur ce dernier fichier (lecture, écriture, exécution). Nous déplaçons ensuite <code>phpunit.phar</code> dans le dossier <code>/usr/local/bin/phpunit</code> afin que nous puissions l’exécuter directement depuis notre terminal via la commande <code>phpunit</code>.</p>
<h2 id="Creation-du-fichier-phpunit-xml-contenant-l’ensemble-des-variables-d’environnement"><a href="#Creation-du-fichier-phpunit-xml-contenant-l’ensemble-des-variables-d’environnement" class="headerlink" title="Création du fichier phpunit.xml contenant l’ensemble des variables d’environnement"></a>Création du fichier phpunit.xml contenant l’ensemble des variables d’environnement</h2><p>Si vos scripts PHP font usage de <strong>variables d’environnement</strong>. Vous vous devez de <strong>fournir une valeur à ces variables dans vos tests unitaires</strong>. En effet si vous exécutez vos tests unitaires sans ces variables définies vos test échoueront, faute de variables définies.</p>
<p>PHPUnit permet la configuration de ces variables de manière très simple. Il vous suffit de créer un fichier nommé <code>phpunit.xml</code> à la racine du dossier de votre application :</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">phpunit</span> <span class="attr">bootstrap</span>=<span class="string">"bootstrap_file.php"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">php</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">env</span> <span class="attr">name</span>=<span class="string">"DB_HOST"</span> <span class="attr">value</span>=<span class="string">"127.0.0.1:3306"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">env</span> <span class="attr">name</span>=<span class="string">"DB_USER"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">env</span> <span class="attr">name</span>=<span class="string">"DB_PASS"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></div><div class="line">       ...</div><div class="line">  <span class="tag">&lt;/<span class="name">php</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">phpunit</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Dans notre cas nous définissons ici <code>3</code> variables d’environnement nommées <code>DB_HOST</code>, <code>DB_USER</code> et <code>DB_PASS</code> ayant respectivement les valeurs <code>127.0.0.1:3306</code>, <code>root</code>, <code>root</code>.</p>
<p>D’autre part dans ce fichier de configuration est aussi définit un fichier de <code>bootstrap</code> qui va nous permettre de créer une procédure de démarrage spécifique au test de notre application.</p>
<h2 id="Creation-du-script-de-bootstrap"><a href="#Creation-du-script-de-bootstrap" class="headerlink" title="Création du script de bootstrap."></a>Création du script de bootstrap.</h2><p>Notre script de <code>bootstrap</code> devra effectuer une tâche :</p>
<ul>
<li>Charger l’ensemble des classes que nous avons développées afin que nous n’ayons pas à faire des <code>require</code> dans chaque fichier décrivant un test unitaire. Cette astuce permet de gagner un temps précieux !</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">my_autoloader</span><span class="params">($class)</span> </span>&#123;</div><div class="line">	<span class="keyword">include</span> <span class="string">'classes/'</span> . $class . <span class="string">'.php'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">spl_autoload_register(<span class="string">'my_autoloader'</span>);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>Si <strong>toutes vos classes sont regroupées</strong> dans le dossier <code>classes</code> (sans sous-dossiers) situé à la racine de votre application vous pouvez adopter cet autoloader simple. Une autre contrainte est que le nom de vos classes doit correspondre trait pour trait au nom du fichier dans lesquels elles sont définies.</p>
<p> Jess Telford fournit une implémentation plus complexe permettant d’inclure les sous dossiers : <a href="http://jes.st/2011/phpunit-bootstrap-and-autoloading-classes/" target="_blank" rel="external">http://jes.st/2011/phpunit-bootstrap-and-autoloading-classes/</a>.</p>
<h2 id="Un-test-unitaire"><a href="#Un-test-unitaire" class="headerlink" title="Un test unitaire"></a>Un test unitaire</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">date_default_timezone_set(<span class="string">'America/Los_Angeles'</span>);</div><div class="line"><span class="comment">// require composer classes</span></div><div class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> .<span class="string">'/../vendor/autoload.php'</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">PHPUnit</span>\<span class="title">Framework</span>\<span class="title">TestCase</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Et voilà. Vous pouvez tester des fonctions disposant de <code>variables d&#39;environnement</code> et tester toutes vos classes sans avoir à penser à appeler <code>require</code> à chaque utilisation d’une nouvelle classe.</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/10/01/Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement/" data-id="civ0u11np0002hcmib7jqna8a" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/10/01/Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Comprendre-les-headers-d-une-requete-HTTP" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/30/Comprendre-les-headers-d-une-requete-HTTP/">Comprendre les headers d&#39;une requête HTTP</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/30/Comprendre-les-headers-d-une-requete-HTTP/" class="article-date"><time datetime="2016-09-30T12:31:36.000Z" itemprop="datePublished">30/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>HTTP signifie (Hypertext Transfer Protocol), il s’agit d’un <strong>protocole de communication entre ordinateurs connectés au réseau internet*</strong>. Lorsque nous échangeons avec nos semblables nous utilisons nous même un protocole de communication : il s’agit de notre langue et de notre grammaire. L’Internet dispose aussi d’un langage et d’une grammaire bien déterminée et il s’agit d’HTTP.</p>
<p>Contrairement au français ou comprendre et apprendre la grammaire nécessite un apprentissage long et douloureux, la grammaire du web est définit sous forme de <strong>RFC (“request for comments”)</strong>, il s’agit d’une pléthore de documents décrivant les règles de fonctionnement de notre web. Plus précisément, c’est la <a href="https://www.ietf.org/rfc/rfc2616.txt" target="_blank" rel="external"><strong>RFC 2616</strong></a> qui définit le fonctionnement du <strong>protocole HTTP version 1.1</strong>.</p>
<h2 id="Client-et-Serveur"><a href="#Client-et-Serveur" class="headerlink" title="Client et Serveur"></a>Client et Serveur</h2><p><img src="img/HTTP_server_and_client.png" alt="Le trajet d&#39;une requête HTTP"></p>
<p>Sur le schéma précédent nous voyons que les requêtes HTTP sont émises depuis le <strong>client</strong>. Le client est dans ce cas le navigateur web utilisé (ici Chrome). Ce dernier va envoyer au <strong>serveur</strong> la <strong>requête</strong> HTTP (la question). Ce dernier va ensuite traité la requête et renvoyer la <strong>ressource</strong> correspondante au client.</p>
<h2 id="Les-principales-caracteristiques-du-protocole"><a href="#Les-principales-caracteristiques-du-protocole" class="headerlink" title="Les principales caractéristiques du protocole"></a>Les principales caractéristiques du protocole</h2><ol>
<li>Les échanges du protocoles HTTP repose sur <strong>TCP/IP</strong> qui est une suite de protocoles destinés au transfert de données sur le réseau internet.</li>
<li>On peut transférer via HTTP <strong>n’importe quel type de média</strong> ! Que cela soit du texte, du HTML, du JSON, des images, des films (pensez aux sites de streaming qui reposent grandement sur HTTP).</li>
<li>Le protocole HTTP est <strong>sans état</strong>, c’est à dire que le serveur ne se souviendra pas de vous entre vos requêtes, d’une certaine façon HTTP n’a pas de mémoire. Et cela lui va très bien (cf <a href="/2016/09/24/Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful/">REST</a>)</li>
</ol>
<h2 id="Visualisation-d’une-requete-HTTP"><a href="#Visualisation-d’une-requete-HTTP" class="headerlink" title="Visualisation d’une requête HTTP"></a>Visualisation d’une requête HTTP</h2><p>Comment peut on visualiser une requête HTTP dans Chrome ? Rien de plus simple il suffit de :</p>
<ol>
<li>Cliquer sur <code>Afficher</code></li>
<li>Puis sur <code>Options pour les développeurs</code></li>
<li>Puis cliquez sur <code>outil de développement</code></li>
</ol>
<p>Vous verrez s’afficher la fenêtre vous permettant de surveiller l’activité de <strong>networking</strong> de votre navigateur, autrement dit toutes les requêtes qui sortent de votre machine :</p>
<p><img src="img/visualisation_http_chrome.png" alt="Les requêtes HTTP dans Chrome"></p>
<p>Nous voyons donc ici toutes les requêtes lancées par <strong>chrome</strong> à la visite du site <strong>Le Monde</strong>. Et cela en fait un sacré paquet ! En effet les éléments du site sont chargés via HTTP. Souvenez vous, ce protocole est multimédia ! On va y recourir (enfin notre navigateur) pour charger les images, les feuilles de style CSS, les pages HTML, le favicon…</p>
<p>Voici un exemple de requête HTTP.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Request URL:http://www.lemonde.fr/</div><div class="line">Request Method:GET</div></pre></td></tr></table></figure>
<p>L’URL permet de router notre requête vers le serveur correspondant au site web sur le réseau. Ensuite on précise la méthode, ici il s’agit de <strong>GET</strong>. La méthode <strong>GET</strong> est surtout celle utilisée pour charger les images et les pages  HTML. Il existe d’autres méthodes, appelées aussi <strong>verbes</strong> comme <strong>POST</strong> qui est utilisée notamment pour envoyer les données d’un formulaire sur un serveur. (par exemple pour envoyer votre formulaire d’inscription à Airbnb).</p>
<p> Mais une <strong>requête HTTP</strong> est aussi composée d’un <strong>header</strong> dont voici un exemple :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">GET / HTTP/1.1</div><div class="line">Host: www.lemonde.fr</div><div class="line">Connection: keep-alive</div><div class="line">Cache-Control: max-age=0</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.34 Safari/537.36</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</div><div class="line">Accept-Encoding: gzip, deflate, sdch</div><div class="line">Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4</div><div class="line">Cookie: _ga=GA1.2.374864853.1475228586; xtvrn=<span class="variable">$43260</span>$; _cb_ls=1; lmdAbDay=1; __vrf=14752522666255dKTLyAPMbCEHo57kMWgskL26Q4Wie1W; __vrrefresh=http%253A%252F%252Fwww.lemonde.fr%252F; __utmt=1; __utma=194882738.374864853.1475228586.1475238480.1475252268.2; __utmb=194882738.1.10.1475252268; __utmc=194882738; __utmz=194882738.1475238480.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); xtan43260=-; xtant43260=1; _cb=DQQzWqCueIlMC6ZCTd; _chartbeat2=.1475238481310.1475252269278.1; cdx_ses_1_10013=3342761584&amp;1577be3312a&amp;1577be3312a&amp;; kameleoonVisit=ml6c91nkhia4vvot/1/1475252301068/20160909/12726701/<span class="literal">true</span></div><div class="line">If-Modified-Since: Fri, 30 Sep 2016 16:10:47 GMT</div></pre></td></tr></table></figure>
<p>Chaque ligne est générée par notre client (notre navigateur web). D’un point de vue développeur <strong>il ne faut d’ailleurs jamais se fier au header car ces données peuvent être manipulées avant d’être envoyées</strong> et changées à volonté par n’importe quel développeur.</p>
<p>Voici le détail du header avec des explications pour chaque donnée</p>
<table>
<thead>
<tr>
<th style="text-align:center">Propriété</th>
<th style="text-align:center">Description</th>
<th style="text-align:center">Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Host</td>
<td style="text-align:center">Il s’agit du nom de domaine du serveur auquel on envoie la requête, on pécise aussi le port si celui-ci n’est pas 80</td>
<td style="text-align:center">www.lemonde.fr</td>
</tr>
<tr>
<td style="text-align:center">Connection</td>
<td style="text-align:center">Il s’agit du comportement de la connexion. Ici on va garder la connection TCP ouverte entre le moment entre les requêtes réponses, au lien d’en ouvrir une autre à chaque reprise</td>
<td style="text-align:center">keep-alive</td>
</tr>
<tr>
<td style="text-align:center">Cache-Control</td>
<td style="text-align:center">Cette propriété indique au cache du serveur s’il doit recharger la page à chaque reprise ou suivant un délai précis. Ici c’est le cas, on doit recharger à chaque fois la page</td>
<td style="text-align:center">max-age=0</td>
</tr>
<tr>
<td style="text-align:center">Upgrade-Insecure-Requests</td>
<td style="text-align:center">Indique au client que l’on préfèrera toujours une reconnection HTTPS si jamais celui-ci est en train de migrer entre HTTP et HTTPS</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">User-Agent</td>
<td style="text-align:center">Il s’agit de la chaine de caractère permettant d’identifier formellement le navigateur qui a généré la requête;  on y trouve sa version son développeur … Renseignement très intéressant pour le web analytics</td>
<td style="text-align:center">Mozilla/5.0 (Macintosh; ….</td>
</tr>
<tr>
<td style="text-align:center">Accept</td>
<td style="text-align:center">Indique le type de contenu (de média) que le client est en mesure d’accepter.</td>
<td style="text-align:center">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8</td>
</tr>
<tr>
<td style="text-align:center">Referer</td>
<td style="text-align:center">Indique la page d’où vient le visiteur. (très utile pour l’analyse de la provenance des visiteurs). Vous noterez la coquille (il manque un r) qui provient directement d’une erreur sur la RFC :)</td>
<td style="text-align:center"><a href="http://www.lemonde.fr/" target="_blank" rel="external">http://www.lemonde.fr/</a></td>
</tr>
<tr>
<td style="text-align:center">Accept-Encoding</td>
<td style="text-align:center">Spécifie le type de compression du contenu que le client (le navigateur) peut traiter. Le contenu est en effet souvent compresser pour optimiser le temps de transfert !</td>
<td style="text-align:center">gzip, deflate, sdch</td>
</tr>
<tr>
<td style="text-align:center">Accept-Language</td>
<td style="text-align:center">Spécifie quel langage le client accepte</td>
<td style="text-align:center">fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4</td>
</tr>
<tr>
<td style="text-align:center">Cookie</td>
<td style="text-align:center">On retrouve ici le cookie (une série de données) qui avait été précédemment enregistré sur le navigateur de l’utilisateur et qui est renvoyé au serveur lors de chaque requêtes. On retrouve d’ailleurs ici des traces de Google Analytics</td>
<td style="text-align:center">_ga=GA1.2.374864853.1475228586; xtvrn=$43260$; _cb_ls=1</td>
</tr>
<tr>
<td style="text-align:center">If-Modified-Since</td>
<td style="text-align:center">Permet au serveur de renvoyer la réponse “304 Not modified” si jamais la page n’a pas été modifiée depuis la date indiquée</td>
<td style="text-align:center">Fri, 30 Sep 2016 16:16:34 GMT</td>
</tr>
</tbody>
</table>
<p>Précisons d’ailleurs que l’on peut mettre en place un <strong>système d’authentification</strong> utilisateur via les headers HTTP ! Le client rajoute simplement dans sa requête le nom d’utilisateur et le mot de passe demandé à l’utilisateur via une fenêtre native. Ce nom d’utilisateur est de mot de passe est encodé en <strong>base 64</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Authorization: Basic XXXXXXXXXXXX</div></pre></td></tr></table></figure></p>
<p>XXXXXXXXXXXX représentant l’encodage de la chaine nom_de_l_utilisateur : mot_de_passe ! Remarquez aussi que lorsque vous transmettez des <strong>données sensibles</strong> sur vos sites favoris et que ces derniers n’utilisent pas HTTPS (la version sécurisée du protocole HTTP) cela <strong>représente un réel danger</strong>, car toute requête peut être interceptée ! et dans une requête POST de transmission de formulaire <strong>vos données sont lisibles</strong>! Faites l’essai en essayant de remplir un formulaire et en surveillant la requête HTTP qui sera émise ! </p>
<p>J’espère que vous aurez maintenant envie d’ouvrir votre inspecteur chrome afin d’inspecter les requêtes que fait votre navigateur ! Cela peut être un moyen intéressant pour découvrir tous les services qu’un site utilise (par exemple les réseaux de pubilicités, les services de web analytics…). Fouillez !</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/30/Comprendre-les-headers-d-une-requete-HTTP/" data-id="civ0u11o3000hhcmicng0ouhl" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/30/Comprendre-les-headers-d-une-requete-HTTP/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTTP/">HTTP</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Machine-Learning-comment-fonctionne-la-classification-naive-Bayesienne" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/29/Machine-Learning-comment-fonctionne-la-classification-naive-Bayesienne/">Machine Learning : comment fonctionne la classification naïve Bayesienne</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/29/Machine-Learning-comment-fonctionne-la-classification-naive-Bayesienne/" class="article-date"><time datetime="2016-09-29T08:38:02.000Z" itemprop="datePublished">29/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Un-classifieur-rapide-et-econome-en-puissance-de-calcul"><a href="#Un-classifieur-rapide-et-econome-en-puissance-de-calcul" class="headerlink" title="Un classifieur rapide et économe en puissance de calcul"></a>Un classifieur rapide et économe en puissance de calcul</h2><h3 id="Qu’est-ce-qu’un-classifieur"><a href="#Qu’est-ce-qu’un-classifieur" class="headerlink" title="Qu’est ce qu’un classifieur ?"></a>Qu’est ce qu’un classifieur ?</h3><p>Un <strong>classifieur</strong> est un algorithme permettant de définir la classe d’un objet suivant certaines de ses propriétés. Pour bâtir notre classifieur nous avons à notre disposition un ensemble d’objets dont on connait la classe par avance. Ce set d’objet est appelé set d’<strong>entrainement</strong>.</p>
<p>Par exemple, nous souhaitons classé des textes selon deux classes : écrit scientifique OU écrit romanesque  (classification appelée binaire car composée de deux classes). Nous aurons donc à notre disposition un ensemble composé de 20 textes dont 12 classés “écrit romanesque” et les autres classés “écrit scientifique”.</p>
<p>Notre problème va donc consister à classer un nouveau texte en fonction de son contenu dans ces deux classes.</p>
<h3 id="Utilisation-de-la-theorie-des-probabilites"><a href="#Utilisation-de-la-theorie-des-probabilites" class="headerlink" title="Utilisation de la théorie des probabilités"></a>Utilisation de la théorie des probabilités</h3><p>Notre algorithme aura la lourde tâche de fournir une classe à notre nouveau texte. Notre approche dans le cas de la classification naïve Bayesienne va être <strong>probabiliste</strong>. Nous allons chercher à déterminer la probabilité que notre objet appartient à la classe “écrit romanesque” à la probabilité que notre écrit appartient à l’autre classe. Nous allons ensuite <strong>comparer</strong> ces deux probabilités pour sélectionner la plus <strong>grande</strong> des deux.</p>
<p>Trouver la classe revient donc à <strong>calculer deux grandeurs et les comparer</strong>. Ce qui si on compare à l’algorithme des K voisins les plus proches (voir l’article <a href="https://maximilienandile.github.io/2016/09/24/L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs/">ici</a>) est très économe en calculs. Avant d’étudier plus en détail d’algorithme nous nous devons de faire un rappel sur les probabilités conditionnelles, qui constituent le fer de lance de cet algorithme.</p>
<h2 id="Un-passage-oblige-par-les-probabilites-conditionnelles"><a href="#Un-passage-oblige-par-les-probabilites-conditionnelles" class="headerlink" title="Un passage obligé par les probabilités conditionnelles"></a>Un passage obligé par les probabilités conditionnelles</h2><p>La probabilité d’un événement A est <strong>un nombre variant entre 0 et 1</strong> qui traduit le <strong>degrés de chance qu’un évènement A se produise</strong>. Plus on s’approche de la valeur 1 plus cet événement aura de chance de se dérouler.</p>
<p>Par exemple si on prend l’événement A “une élection va se dérouler en 2017”. La probabilité de cet événement est de 1 car il s’agit d’un événement certain.</p>
<p>Une <strong>probabilité conditionnelle</strong> est légèrement plus complète dans le sens où <strong>elle intègre dans son calcul un autre évènement</strong>. Ainsi une probabilité conditionnelle traduit le degrés de chance qu’un élément se produise <strong>sachant</strong> qu’un autre évènement s’est produit.</p>
<p>Par <strong>exemple</strong>, si on prend l’évènement A “réussite d’un test de maths”. L’évènement B “être mathématicien” et l’évènement C “avoir suivi un cursus scolaire littéraire”. Alors la probabilité de A sachant l’évènement B sera plus importante que la probabilité de A sachant l’événement C.</p>
<p>Mathématiquement on note une probabilité conditionnelle de deux façons :</p>
<span>$P_{B}(A) = P(A | B)$</span><!-- Has MathJax -->
<p>La formule des probabilités conditionnelles se calcul ainsi :</p>
<span>$P_{B}(A) = P(A | B) = \frac{P(A  \cap  B)}{P(B)}$</span><!-- Has MathJax -->
<h2 id="La-formule-de-Bayes"><a href="#La-formule-de-Bayes" class="headerlink" title="La formule de Bayes"></a>La formule de Bayes</h2><h3 id="Fonctionnement-theorique"><a href="#Fonctionnement-theorique" class="headerlink" title="Fonctionnement théorique"></a>Fonctionnement théorique</h3><p>Prenons un exemple afin de comprendre de quoi il en retourne. Imaginons un hôpital dans lequel on fait passer un test de dépistage de la tuberculose à certains patients. Les médecins dispose de données permettant d’établir que la fiabilité de ce test est de 90%, c’est à dire que 90% des tests sont fiables (les patients sont vraiment malades), il reste que 10% des tests sont des faux-positifs ou des faux-négatifs (le patient est bien malade mais dispose d’un test lui indiquant le contraire).</p>
<p>La formule de Bayes pourra nous donner la réponse à la question suivante : <strong>“sachant que le test de M.X est positif quel est la probabilité que celui-ci ne soit pas malade ?”</strong> On cherche donc à remonter dans le temps…</p>
<p>La formule de Bayes est définie ainsi :<br><span>$P_{B}(A) =  \frac{P_{A}(B).P(A)}{P(B)}$</span><!-- Has MathJax --></p>
<p>Si on n’applique la formule à notre exemple on aura :</p>
<ul>
<li>A : Ne pas être malade</li>
<li>B : Avoir un résultat de test positif</li>
</ul>
<p>Ainsi la probabilité de ne pas être malade sachant qu’on a un test de dépistage positif est le <strong>rapport</strong> <strong>entre</strong> la probabilité d’avoir un résultat positif sachant qu’on est malade multiplié par la probabilité de ne pas être malade <strong>et</strong> la probabilité d’avoir un résultat de test positif.</p>
<h3 id="Application-a-un-probleme-de-classification"><a href="#Application-a-un-probleme-de-classification" class="headerlink" title="Application à un problème de classification"></a>Application à un problème de classification</h3><p>On va chercher dans notre cas la probabilité qu’un objet appartient à la classe <strong>i</strong> sachant qu’il a les propriétés <strong>x</strong> et <strong>y</strong>. Soit :</p>
<center><br><span>$P_{x,y}(C_i)$</span><!-- Has MathJax --><br></center>



<p>Si on a <strong>deux classes (1 et 2)</strong> dans notre problème nous allons donc <strong>comparer</strong> deux grandeurs :</p>
<center><br><span>$P_{x,y}(C_1) et P_{x,y}(C_2)$</span><!-- Has MathJax --><br></center>


<p>Dans tous les cas nous devrons isoler des <strong>features</strong>, des propriétés relatives aux objets que nous souhaitons classer. Si nous souhaitons donc classer un document nous prendons par exemple 1000 propriétés correspondant chacune à la présence ou non d’un mot courant dans le texte.</p>
<h3 id="Pourquoi-cet-algorithme-est-il-naif"><a href="#Pourquoi-cet-algorithme-est-il-naif" class="headerlink" title="Pourquoi cet algorithme est-il naïf ?"></a>Pourquoi cet algorithme est-il naïf ?</h3><p>Nous faisons deux assomptions un peu naïves sur notre données :</p>
<ul>
<li>Les <strong>features</strong> ou les <strong>propriétés</strong> sont <strong>indépendantes</strong> les unes des autres. Or c’est rarement le cas, si on prend les classifications de textes la présence d’un mot peut être lié à la présence d’un autre mot !</li>
<li>On fait aussi le postulat que les <strong>features</strong> sont d’importances équivalentes dans la tâche de classification, ce qui n’est encore pas vraiment le cas. Pour certains textes la présence d’un mot ou d’un groupe de mot est très signifiant dans leur classe.</li>
</ul>
<h3 id="Application-en-NodeJS-via-le-module-“bayes”"><a href="#Application-en-NodeJS-via-le-module-“bayes”" class="headerlink" title="Application en NodeJS via le module “bayes”"></a>Application en NodeJS via le module “bayes”</h3><p>Nous allons créer un script permettant de classer des phrases selon deux classes : les phrases provenant de romans et ceux d’écrits scientifiques.</p>
<ul>
<li><p>Créez un nouveau dossier nommé <code>bayes_classifier</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ mkdir bayes_classifier</div></pre></td></tr></table></figure>
</li>
<li><p>Placez vous dans ce dossier</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> bayes_classifier</div></pre></td></tr></table></figure>
</li>
<li><p>Initialisez <code>npm</code></p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm init</div></pre></td></tr></table></figure>
<ul>
<li>Après avoir répondu à l’ensemble des questions installez le module <code>bayes</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install bayes --save</div></pre></td></tr></table></figure>
<ul>
<li><p>Créez un nouveau fichier <code>index.js</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ touch index.js</div></pre></td></tr></table></figure>
</li>
<li><p>Dans ce fichier faites un require du module bayes.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> bayes = <span class="built_in">require</span>(<span class="string">'bayes'</span>)</div><div class="line"><span class="keyword">var</span> classifier = bayes()</div></pre></td></tr></table></figure>
</li>
<li><p>Nous allons ensuite entrainer notre modèle pour reconnaître les écrits romanesques (fiction):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Make the algorithm learn the training data</span></div><div class="line"><span class="comment">// The Great Gatsby</span></div><div class="line">classifier.learn(<span class="string">'Il me sourit avec une sorte de complicité - qui allait au-delà de la complicité.'</span>, <span class="string">'fiction'</span>)</div><div class="line"><span class="comment">// 1984 (Orwell)</span></div><div class="line">classifier.learn(<span class="string">'Celui qui a le contrôle du passé, disait le slogan du Parti, a le contrôle du futur. Celui qui a le contrôle du présent a le contrôle du passé.'</span>, <span class="string">'fiction'</span>)</div><div class="line"><span class="comment">// Le dernier Jour d'un Condamné (Hugo)</span></div><div class="line">classifier.learn(<span class="string">'Maintenant je suis captif. Mon corps est aux fers dans un cachot, mon esprit est en prison dans une idée.'</span>,<span class="string">'fiction'</span>)</div><div class="line"><span class="comment">// Guerre et Paix (Tolstoï)</span></div><div class="line">classifier.learn(<span class="string">'Oui, ils m ont accablé de reproches là-bas, et pour la guerre et pour la paix...'</span>,<span class="string">'fiction'</span>)</div><div class="line"><span class="comment">// Les Caractères (La Bruyères)</span></div><div class="line">classifier.learn(<span class="string">'on n aime qu une seule fois : c est la première ; les amours qui suivent sont moins involontaires.'</span>,<span class="string">'fiction'</span>)</div><div class="line"><span class="comment">// O.Wilde</span></div><div class="line">classifier.learn(<span class="string">"S'aimer soi-même, c'est l'assurance d'une longue histoire d'amour."</span>,<span class="string">"fiction"</span>)</div></pre></td></tr></table></figure>
</li>
<li><p>Entrainons le maintenant pour reconnaître des écrits scientifiques (science):</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * MAKE IT LEARN SCIENCE...</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="comment">//La sensibilité de l'activité mathématique aux ostensifs, BOSCH M.  ; CHEVALLARD Y. ;</span></div><div class="line">classifier.learn(<span class="string">'Les écritures, symboles, mots, discours, graphismes et gestes mobilisés dans l activité mathématique - soit ce que nous appelons, pour leur caractère matériel et perceptible, les objets ostensifs'</span>,<span class="string">'science'</span>)</div><div class="line"><span class="comment">// http://www.pourlascience.fr/ewb_pages/a/actu-des-panaches-de-vapeur-d-eau-observes-sur-europe-37639.php</span></div><div class="line">classifier.learn(<span class="string">"De nouvelles observations suggèrent que des geysers de vapeur d’eau jaillissent du pôle Sud de la lune glacée de Jupiter."</span>,<span class="string">"science"</span>)</div><div class="line"><span class="comment">// pourlascience</span></div><div class="line">classifier.learn(<span class="string">"La pédagogie haptique rend l'élève acteur de son enseignement. Il est alors plus réceptif aux connaissances qu'on veut lui transmettre."</span>,<span class="string">"science"</span>)</div><div class="line"><span class="comment">// http://cat.inist.fr/?aModele=afficheN&amp;cpsidt=207222</span></div><div class="line">classifier.learn(<span class="string">"La méthode est fondée sur une approche distributionnelle de la sémantique. Les classes sémantiques qu'il est possible d'apprendre à partir d'un corpus analysé"</span>,<span class="string">"science"</span>)</div><div class="line"><span class="comment">// https://hal.archives-ouvertes.fr/tel-00145147/</span></div><div class="line">classifier.learn(<span class="string">"Le panorama du Traitement Automatique des Langues est dominé par deux familles d'approches~: dans la première, la connaissance linguistique s'exprime sous forme de règles (grammaticales pour le traitement syntaxique, d'inférence pour le traitement sémantique, etc.)"</span>,<span class="string">"science"</span>)</div><div class="line"><span class="comment">// https://pdfs.semanticscholar.org/57d0/2d681a479094bbd570b7992952281c39e146.pdf</span></div><div class="line">classifier.learn(<span class="string">" Les outils disponibles de recherche d’information sur le Web ont une approche généraliste, ne prenant pas en compte les caractéristiques de l’utilisateur, ce qui limite la qualité des résultats"</span>,<span class="string">"science"</span>)</div></pre></td></tr></table></figure>
<ul>
<li>Maintenant nous allons tester notre modèle avec deux exemples non classés.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// test the classifier</span></div><div class="line"><span class="keyword">var</span> f = classifier.categorize(<span class="string">"Je la contemplai avec une haine intense, celle qu'un cheveu seul sépare de l'amour ardent."</span>)</div><div class="line"><span class="keyword">var</span> s = classifier.categorize(<span class="string">" Par ailleurs la réalisation d’un système de ce type exige un assemblage de plusieurs techniques utilisées en apprentissage ou en recherche d’information "</span>)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"fiction"</span>,f);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">"science"</span>,s);</div></pre></td></tr></table></figure>
<p>La console affiche :<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fiction fiction</div><div class="line">science science</div></pre></td></tr></table></figure></p>
<p>On a un résultat concordant ! Pour les impatients voici le repo contenant ce morceau de code : <a href="https://github.com/maximilienandile/bayes_classifier" target="_blank" rel="external">https://github.com/maximilienandile/bayes_classifier</a></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/29/Machine-Learning-comment-fonctionne-la-classification-naive-Bayesienne/" data-id="civ0u11o8000lhcmijcgydedp" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/29/Machine-Learning-comment-fonctionne-la-classification-naive-Bayesienne/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/24/L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs/">L&#39;algorithme des K voisins les plus proches et son implémentation en NodeJs</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/24/L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs/" class="article-date"><time datetime="2016-09-24T15:14:17.000Z" itemprop="datePublished">24/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Un-algorithme-simple-mais-gourmand-en-memoire"><a href="#Un-algorithme-simple-mais-gourmand-en-memoire" class="headerlink" title="Un algorithme simple mais gourmand en mémoire"></a>Un algorithme simple mais gourmand en mémoire</h2><p>L’algorithme des K voisins les plus proches repose sur la notion de <strong>distance</strong> entre des éléments classifiés et des nouveaux éléments à classer. La tâche principale de cet algorithme est de pouvoir <strong>prévoir une catégorisation d’un objet à partir d’objets dont on connait la déjà la catégorie</strong>.</p>
<p>L’idée est de décortiquer nos objets suivants des propriétés nominales ou numériques et pour classer un nouvel objet, il suffit d’identifier les éléments les plus <strong>proches</strong>, les plus semblables. C’est pourquoi on parle de voisins. La lettre K fait quand à elle référence au nombre de voisins que l’on doit étudier pour déterminer la classe.</p>
<p>Si in prends par exemple la classification de détection de la musique électronique, dont le but serait d’identifier les morceaux de musique électronique et ceux qui ne le sont pas. On pourrait imaginer un algorithme étudiant le tempo et le nombre de mots chantés par l’artiste. On aurait déjà une centaine de morceaux étudiés et classé. Lorsqu’on veut classer un nouveau morceau il suffirait de regarder ces deux indicateurs pour déterminer une ressemblance avec l’ensemble des morceaux déjà catégorisés…</p>
<h2 id="Un-exemple"><a href="#Un-exemple" class="headerlink" title="Un exemple !"></a>Un exemple !</h2><p>Pour bien comprendre notre algo nous allons prendre un exemple réel, celui de l’immobilier. Imaginons une agence pourvue d’un jeune stagiaire qui souhaiterait prédire le temps de vente d’un bien.</p>
<p>Toute chose égales par ailleurs il pourrait considérer deux facteurs : le nombre de parcs publics présents à moins de 20 min à pied du logement et le nombre de pièces.</p>
<h3 id="Donnee-d’entrainement"><a href="#Donnee-d’entrainement" class="headerlink" title="Donnée d’entrainement"></a>Donnée d’entrainement</h3><p>Ce dernier va donc constituer <strong>un set de données d’entrainement</strong> avec l’ensemble des transactions de son agence. Chaque bien est donc classé en deux catégories : ceux qui se sont vendus rapidement et ceux qui ont nécessité un temps plus important pour être cédés.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Bien 1 : Pièces : 1 - Parcs : 2 - Catégorie : vendu rapidement</div><div class="line">Bien 2 : Pièces : 2 - Parcs : 3 - Catégorie : vendu rapidement</div><div class="line">Bien 3 : Pièces : 1 - Parcs : 1 - Catégorie : vendu rapidement</div><div class="line">Bien 4 : Pièces : 3 - Parcs : 0 - Catégorie : vendu rapidement</div><div class="line">Bien 5 : Pièces : 1 - Parcs : 1 - Catégorie : vendu rapidement</div><div class="line">...</div></pre></td></tr></table></figure>
<h3 id="Nouvel-exemple-a-classer"><a href="#Nouvel-exemple-a-classer" class="headerlink" title="Nouvel exemple à classer"></a>Nouvel exemple à classer</h3><p>Tout le bureau est excité, on rentre un nouvel appartement (2 pièces, et 2 parcs à proximité) ! Chacun y va de son pronostique, mais notre stagiaire a une méthode secrète :</p>
<p>Il va donc déterminer la distance de ce nouveau bien avec chacun des biens déjà vendus et il va déduire des trois biens les plus proches pour savoir ce qu’il en sera de ce bien.</p>
<p>L’algorithme va donc consister à un calcul de distance puis on va sélectionner la classe dominante parmi les 3 classes des 3 voisins les plus proches.</p>
<h2 id="Mise-en-pratique-avec-Nodejs"><a href="#Mise-en-pratique-avec-Nodejs" class="headerlink" title="Mise en pratique avec Nodejs"></a>Mise en pratique avec Nodejs</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// nous ferons grand usage du module</span></div><div class="line"><span class="comment">// lodash qui est bien pratique lorsqu'on</span></div><div class="line"><span class="comment">// travaille sur des tableaux avec nodejs (https://lodash.com/)</span></div><div class="line"><span class="keyword">var</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>)</div><div class="line"></div><div class="line"><span class="comment">// On crée une variable data contenant un Array de l'ensemble de nos</span></div><div class="line"><span class="comment">// appartements déjas vendus dans le passé (cahcun des apprt est dans un sous tableau,</span></div><div class="line"><span class="comment">// le premier chiffre présentant le nombre de pièces, le second le nombre de parcs)</span></div><div class="line"><span class="keyword">var</span> data_training = [[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">3</span>,<span class="number">0</span>],[<span class="number">1</span>,<span class="number">1</span>]];</div><div class="line"><span class="comment">// Pour chaque élément de notre tableau on associe une étiquette</span></div><div class="line"><span class="keyword">var</span> labels = [<span class="string">"vendu"</span>, <span class="string">"non_vendu"</span>,<span class="string">"non_vendu"</span>,<span class="string">"vendu"</span>,<span class="string">"vendu"</span>]</div><div class="line"></div><div class="line"><span class="comment">//Partie 2 :  Notre élément à classer</span></div><div class="line"><span class="comment">// 2 pièces, 2 parcs à proximité (l'ordre est capital !)</span></div><div class="line"><span class="keyword">var</span> element_to_class = [<span class="number">2</span>,<span class="number">2</span>]</div><div class="line"></div><div class="line"><span class="comment">// on crée un array vide</span></div><div class="line"><span class="comment">// pour contenir l'ensemble de nos résultats de cacul de distance</span></div><div class="line"><span class="keyword">var</span> array_of_results =[]</div><div class="line"></div><div class="line"><span class="comment">//Partie 3 :  calcul de la distance</span></div><div class="line"><span class="comment">// on itère sur notre set d'entrainement</span></div><div class="line">_.forEach(data_training, <span class="function"><span class="keyword">function</span>(<span class="params">element_of_array, key</span>) </span>&#123;</div><div class="line"> <span class="comment">// Pour le premier passage dans la boucle</span></div><div class="line"> <span class="comment">// element_of_array= [1,2]</span></div><div class="line"> <span class="comment">// calcul ( Xa0 - Xb0 )^2</span></div><div class="line"> <span class="keyword">var</span> difference_square_first_feature = (element_to_class[<span class="number">0</span>]-element_of_array[<span class="number">0</span>])*(element_to_class[<span class="number">0</span>]-element_of_array[<span class="number">0</span>])</div><div class="line"> <span class="comment">// calcul ( Xa1 - Xb1 )^2</span></div><div class="line"> <span class="keyword">var</span> difference_square_second_feature = (element_to_class[<span class="number">1</span>]-element_of_array[<span class="number">1</span>])*(element_to_class[<span class="number">1</span>]-element_of_array[<span class="number">1</span>])</div><div class="line"> <span class="comment">// Calcul de la différence euclidienne</span></div><div class="line"> <span class="keyword">var</span> euclidean_distance = <span class="built_in">Math</span>.sqrt(difference_square_first_feature + difference_square_second_feature)</div><div class="line"></div><div class="line"> <span class="comment">// Création d'un objet contenant le résultat du calcul de la distance</span></div><div class="line"> <span class="keyword">var</span> result = &#123;&#125;</div><div class="line"> result.euclidean_distance = euclidean_distance</div><div class="line"> result.label = labels[key]</div><div class="line"></div><div class="line"> <span class="comment">// on pousse cet objet dans notre tableau</span></div><div class="line"> array_of_results.push(result)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// nous devons maintenant trouver les trois classes dont la distance est la plus faible</span></div><div class="line"><span class="comment">// pour trouver la classe de notre élément à classe (element_to_class)</span></div><div class="line"><span class="comment">// Nous classons donc le tableau array_of_results par la propriété euclidean_distance</span></div><div class="line"><span class="comment">// de manières ascendate (asc)</span></div><div class="line"><span class="keyword">var</span> array_ordened = _.orderBy(array_of_results, [<span class="string">'euclidean_distance'</span>], [<span class="string">'asc'</span>]);</div><div class="line"></div><div class="line"><span class="comment">// nous prenons les trois premiers voisins</span></div><div class="line"><span class="keyword">var</span> three_first = _.take(array_ordened, <span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="comment">//three first sera égale à</span></div><div class="line"><span class="comment">//[ &#123; euclidean_distance: 33, label: 'non_vendu' &#125;,</span></div><div class="line"><span class="comment">// &#123; euclidean_distance: 36.013886210738214, label: 'non_vendu' &#125;,</span></div><div class="line"><span class="comment">// &#123; euclidean_distance: 37, label: 'vendu' &#125; ]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> vote_for_label_vendu = <span class="number">0</span>;</div><div class="line"><span class="keyword">var</span> vote_for_label_non_vendu = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">// pour chcun des trois premiers voisins nous comptons les votes</span></div><div class="line">_.forEach(three_first, <span class="function"><span class="keyword">function</span>(<span class="params">element,key</span>)</span>&#123;</div><div class="line"> <span class="keyword">if</span>(element.label == <span class="string">"vendu"</span>)&#123;</div><div class="line">    vote_for_label_vendu ++;</div><div class="line"> &#125;<span class="keyword">else</span> &#123;</div><div class="line">    vote_for_label_non_vendu ++;</div><div class="line"> &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(vote_for_label_vendu&gt;vote_for_label_non_vendu)&#123;</div><div class="line"> <span class="built_in">console</span>.log(<span class="string">"Ce bien sera vendu rapidement"</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line"> <span class="built_in">console</span>.log(<span class="string">"Ce bien ne sera pas vendu rapidement"</span>);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Pour pouvoir exécuter ce code :</p>
<ol>
<li>Créez un dossier sur votre ordinateur (p.ex immobilier)</li>
<li><p>Ouvres un terminal et déplacez vous avec la commande cd (change directory)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cd immobilier</div></pre></td></tr></table></figure>
</li>
<li><p>Installez lodash (via npm qu’il faut d’abord initialiser)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ npm init</div><div class="line">$ npm install lodash --save</div></pre></td></tr></table></figure>
</li>
<li><p>Créez votre fichier index.js (soit directement via le terminal ou bien avec votre éditeur de code préféré). Ce dernier contiendra le code</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ touch index.js</div></pre></td></tr></table></figure>
</li>
<li><p>Copiez le code précédent.</p>
</li>
<li>Lancez l’algorithme  !<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ node index.js</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Pour bien comprendre je vous invite à reprendre ligne par ligne et d’essayer de le réécrire à votre sauce (l’utilisation de <strong>lodash</strong> (<a href="https://lodash.com/" target="_blank" rel="external">https://lodash.com/</a>) n’est pas obligatoire mais très conseillée)</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/24/L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs/" data-id="civ0u11o2000fhcmif7cic8rj" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/24/L-algorithme-des-K-voisins-les-plus-proches-et-son-implementation-en-Nodejs/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/24/Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful/">Pourquoi utiliser RAML pour designer une API RESTful</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/24/Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful/" class="article-date"><time datetime="2016-09-24T08:39:00.000Z" itemprop="datePublished">24/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Qu’est-ce-qu’un-API"><a href="#Qu’est-ce-qu’un-API" class="headerlink" title="Qu’est ce qu’un API"></a>Qu’est ce qu’un API</h2><p>On a souvent tendance à limiter l’API aux applications web, mais ces dernières sont définies et utilisées au sein de presque tous les langages, applications elles supportent même la programmation et le design d’interface pour le hardware.</p>
<p>API signifie “Application programming interface”, littéralement il s’agit d’une boite à outils contenants l’ensemble du matériel nécessaire pour bâtir un logiciel. Il s’agit de l’ensemble des blocs de construction permettant aux développeurs de bâtir un nouveau logiciel sur une base existante, cette base existante de fonctionnalités étant mise à la disposition du développeur <strong>via</strong> l’API.</p>
<p>Les API sont <strong>protéiformes</strong>, elles sont mises à disposition par les langages de programmation. Par exemple NodeJS fournit au développeur un <strong>ensemble de méthodes et de fonctions pré codées lui permettant de bâtir des programmes sans avoir à réinventer la roue à chaque reprise</strong>.</p>
<p>Prenons l’exemple simple d’un programme que nous souhaiterions construire dont l’unique but est d’ouvrir un fichier sur le disque et d’afficher son contenu. Afin d’utiliser l’API de Nodejs nous allons donc regarder sa documentation et chercher l’outil nous permettant d’ouvrir un fichier et de le lire. Nous trouvons la documentation de cette api sur cette page <a href="https://nodejs.org/api/fs.html" target="_blank" rel="external">https://nodejs.org/api/fs.html</a>.</p>
<p><img src="img/example_presentation_api_nodejs.png" alt="Example de la documentation de l&#39;API de NOdejs"></p>
<p>Au passage, nous abordons ici un point fondamental, la documentation. Une bonne API est bien <strong>documentée</strong> afin de permettre au développeur de bâtir avec rapidité.</p>
<h2 id="Les-API-Web"><a href="#Les-API-Web" class="headerlink" title="Les API Web"></a>Les API Web</h2><p>Nous avons abordé les API fournies par les langages de programmations et les programmes développés à partir de ces derniers mais ce qui va surtout nous intéresser dans cet article ce sont les API Web RESTful.</p>
<p>Une API web est là aussi un ensemble de <strong>ressources</strong> mis à la disposition des développeurs par d’autres développeurs d’application.</p>
<p>Dans la plupart des cas ou nous faisons usage des API Web il s’agit en effet de récupérer de la données d’autres applications. Par exemple nous pouvons utiliser l’API de Twitter pour récupérer l’ensemble des tweets d’un utilisateur. La <strong>récupération de données est usage mais pas le seul des API Web</strong>, Twitter ainsi mets à la disposition des développeurs des API d’authentification leur permettant de laisser gérer par Twitter l’authentification de leur site par Twitter ! C’est aussi le cas de Facebook par exemple avec le Facebook login button.</p>
<p>La <strong>tendance est grande et stratégiquement intéressantes</strong> pour les entreprises de mettre à la disposition leurs données à d’autres entreprises afin que ces dernières créent de la valeur par leur biais. Valeur qui est ensuite récupéré soit directement par un paiement à l’appel (au <code>call</code>) ou indirectement par la croissance de données récupérées sur l’utilisateur final…</p>
<h2 id="REST"><a href="#REST" class="headerlink" title="REST"></a>REST</h2><p> Derrière cette notion d’API Web on rajoute souvent le mot RESTful. Ce dernier terrorise pas mal de développeurs car il sous entend de nombreuses contraintes dans le développement d’une API. Au passage REST signifie (REpresentational State Transfer).</p>
<p> REST est un style architectural pensé dans les années 60 par <strong>Roy Fielding</strong> dans sa thése de doctorat (plus précisément chapitre 5 :)<br> (Pour les curieux voici une traduction française : <a href="http://opikanoba.org/tr/fielding/rest/" target="_blank" rel="external">http://opikanoba.org/tr/fielding/rest/</a>).</p>
<p> Il va donc s’agir pour le créateur de l’API (vous par exemple) de suivre scrupuleusement les principes architecturaux de Roy afin de pouvoir vous vanter d’avoir bâti une API RESTful. Ces principes étant forgés pour une bonne raison, elles assurent que votre API se comportera de manière identique pour 5 utilisateurs comme pour 5 millions (notion de scalabilité). Elle assurera aussi que votre API sera compréhensible par tous le monde car tous le monde utilise le même modèle, (pas forcément le même langage de programmation mais du moins le même mode de fonctionnement)</p>
<p> Nous allons passer brièvement sur les contraintes (qui feront surement l’objet d’un autre article de ma part afin de creuser un peu plus le sujet)</p>
<h2 id="Des-contraintes-architecturales-pensees-pour-notre-bien…"><a href="#Des-contraintes-architecturales-pensees-pour-notre-bien…" class="headerlink" title="Des contraintes architecturales pensées pour notre bien…"></a>Des contraintes architecturales pensées pour notre bien…</h2><p> <strong>Une API RESTFul: :</strong></p>
<ol>
<li><p><strong>Est sans états (Stateless)</strong> : lorsque vous appelez l’API a plusieurs reprises et vous faites la même demande l’API ne se souviendra pas de vos demandes précédentes car elle n’a pas de mémoire. On ne stocke pas d’informations entre les requêtes. Cette contraintes est directement lié au protocole HTTP qui lui même ne conserve pas d’états.</p>
</li>
<li><p><strong>A la possibilité de mettre en “cache” certaines informations.</strong> Par exemple imaginons qu’un nombre important de développeur utilise l’API Open Graph de Facebook pour retrouver le profil de Zuck. On peut parier que cette requête est faite de nombreuses reprises. Facebook (le producteur de l’API) va sans aucun doute <strong>mettre en mémoire la réponse</strong> à cette requête afin d’économiser le temps de recherche dans ces bases de données. La seule contrainte imposée au développeur RESTful est de préciser à l’utilisateur que l’information est en cache. (Afin de ne pas afficher à nos propres utilisateurs des informations non à jour, si jamais Zuck décide de divorcer par exemple)</p>
</li>
<li><p><strong>Doit et peut avoir un système composé de serveurs multiples ou l’information est répliqué</strong>. Facebook par exemple n’a pas qu’un seul serveur, mais dispose d’une armada de machines qui peuvent répondre à la même requête. Cette caractéristique couplée à la première permet d’avoir un système qui va <strong>monter en charge</strong> sans embûche, car si il y a un pic de demande on peut rajouter des serveurs à la volée dans le système.</p>
</li>
<li><p><strong>Une interface uniforme</strong> : cette contrainte est un peu plus difficile à comprendre car elle regroupe elle même 4 contraintes. Ce qu’il est important de retenir est que chaque ressource (données mise à disposition : par exemple le profil Facebook, la liste d’amis, la liste des likes…) est <strong>correctement identifiée</strong> dans les call que l’on va faire à l’API. Je zappe volontairement la contrainte de manipulation des ressources via leur représentation ainsi que la contrainte HATEOAS, traité dans un prochain article. Vient ensuite la notion des messages de retour de l’API. Ces derniers doivent être auto-descriptifs, c’est à dire que le développeur doit comprendre immédiatement ce que l’API revoit. Par exemple en cas d’erreur le développeur doit prévenir le client de son API de la cause de cette dernière.</p>
<h2 id="Batir-une-API-RESTful"><a href="#Batir-une-API-RESTful" class="headerlink" title="Bâtir une API RESTful"></a>Bâtir une API RESTful</h2><p>Tout cela est bel et bon, mais comment donc bâtir avec ces contraintes ? Le défi est important si l’on ne part pas d’une base. Eh bien figurez vous que vous n’êtes pas seul à avoir embrassé la difficulté du REST car des Frameworks existent et permettent de démarrer très rapidement sans avoir à trop transpirer sur vos claviers.</p>
<p>Le sauveur est nommé <strong>RAML</strong>. RAML (<strong>RESTful API Modeling Language</strong>) est un langage vous permettant de désigné une API très rapidement respectant les principes architecturaux de REST. RAML permet de respecter les contraintes tout en étant très facile à lire (il repose sur le langage YAML, format de présentation de données très facile à lire développé par <strong>Clark Evans</strong> en 2001).</p>
<p>Sa facilité de lecture lui permet d’être compréhensible par l’ensemble de la communauté des développeurs. En fait une API grâce à RAML est définit dans un simple fichier. Dans ce dernier on peut voir immédiatement ce que cette dernière fait. Procédé ainsi permet d’avoir un système maintenable sur le long terme.</p>
<blockquote>
<p>Unfortunately, people are fairly good at short-term design, and usually awful at long-term design (Roy Fielding)</p>
</blockquote>
</li>
</ol>
<p>RAML permet d’avoir une rédaction de spécification claire précise efficace et maintenable sur le long terme même si les équipes évoluent. Il est fini le temps ou un seul élément détient le savoir sur le fonctionnement d’une machine.</p>
<p>En guise d’introduction voici un exemple de fichier RAMML définissant une API simple :</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#%RAML 0.8</span></div><div class="line"><span class="meta">---</span></div><div class="line"><span class="attr">title:</span> Facebook API</div><div class="line"><span class="attr">baseUri:</span> http://api.fbbbb.com/&#123;version&#125;</div><div class="line"><span class="attr">version:</span> v1</div><div class="line"></div><div class="line">/users:</div><div class="line">  /&#123;username&#125;</div><div class="line"><span class="attr">    get:</span></div><div class="line"><span class="attr">      queryParameters:</span></div><div class="line"><span class="attr">        first_name:</span></div><div class="line"><span class="attr">          displayName:</span> First Name</div><div class="line"><span class="attr">          type:</span> string</div><div class="line"><span class="attr">          description:</span> The First Name of an user</div><div class="line"><span class="attr">          example:</span> Joe</div><div class="line"><span class="attr">          required:</span> <span class="literal">false</span></div><div class="line"><span class="attr">        last_name:</span></div><div class="line"><span class="attr">          displayName:</span> Last Name</div><div class="line"><span class="attr">          type:</span> string</div><div class="line"><span class="attr">          description:</span> The Lasr Name of an user</div><div class="line"><span class="attr">          example:</span> Doe</div><div class="line"><span class="attr">          required:</span> <span class="literal">false</span></div><div class="line"><span class="attr">    put:</span></div><div class="line"><span class="attr">      queryParameters:</span></div><div class="line"><span class="attr">        access_token:</span></div><div class="line"><span class="attr">          displayName:</span> Access Token</div><div class="line"><span class="attr">          type:</span> string</div><div class="line"><span class="attr">          description:</span> Token giving you permission t put info</div><div class="line"><span class="attr">          required:</span> <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>Ce fichier RAML définit une API imaginaire de Facebook (qui existe bel et bien) permettant de <strong>retrouver des informations sur un utilisateur en particulier</strong> (son prenom et nom).</p>
<p>Par exemple pour recevoir les informations concernant l’utilisateur “jonhdoe75” nous allons juste devoir faire un call sur l’URL suivant :<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://api.fbbbb.com/v1/users/jonhdoe75</div></pre></td></tr></table></figure></p>
<p> La seconde étape consiste à construire l’ensemble de la logic derrière cahque call. Cela peut être fait grâce à Sosprey avec NodeJS (<a href="http://www.raml.org/blogs/osprey-out" target="_blank" rel="external">http://www.raml.org/blogs/osprey-out</a>).</p>
<p> Voici un article à lire pour finir :</p>
<ul>
<li><a href="https://github.com/raml-org/raml-tutorial/blob/master/tutorial.md" target="_blank" rel="external">https://github.com/raml-org/raml-tutorial/blob/master/tutorial.md</a><br>Il s’agit d’un bon tutorial pour commencer à écrire vos premiers fichiers RAML.</li>
</ul>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/24/Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful/" data-id="civ0u11ob000ohcmi490n1tf8" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/24/Pourquoi-utiliser-RAML-pour-designer-une-API-RESTful/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/REST/">REST</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Comment-installer-PHPUnit-sur-macOs-sur-un-projet-PHP-existant-et-ecrire-un-test" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/23/Comment-installer-PHPUnit-sur-macOs-sur-un-projet-PHP-existant-et-ecrire-un-test/">Comment installer PHPUnit sur macOs sur un projet PHP existant et écrire son premier cas de test</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/23/Comment-installer-PHPUnit-sur-macOs-sur-un-projet-PHP-existant-et-ecrire-un-test/" class="article-date"><time datetime="2016-09-23T11:52:41.000Z" itemprop="datePublished">23/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>PHPUnit est un Framework puissant permettant d’automatiser des tests unitaires sur une application écrite en PHP.</p>
<h2 id="Qu’est-ce-qu’un-test-unitaire"><a href="#Qu’est-ce-qu’un-test-unitaire" class="headerlink" title="Qu’est ce qu’un test unitaire"></a>Qu’est ce qu’un test unitaire</h2><p>Usuellement il s’agit d’un morceau de code source permettant de <strong>tester si une fonction (ou une méthode d’une classe en POO) a le fonctionnement attendu.</strong></p>
<p>Ainsi dans l’idéal, <strong>chaque fonction de notre application doit avoir un test associé</strong>. Le rapport entre le nombre de fonctions étant testés effectivement par un test unitaire ET le nombre de fonctions non testés donne une indication de la couverture du code (<code>code coverage</code>)</p>
<p>Chaque test unitaire doit être en général indépendant car associé à une seule et même fonction. Il se peut par contre que l’exécution de la <code>suite de tests</code> nécessite l’exécution d’un <strong>script de démarrage</strong>.</p>
<p>Par exemple si vous voulez tester que la fonction f renvoi bien le nombre de point qu’un de vos utilisateurs a récolté, il faudra bien qu’un script exécuté avant toute chose crée cette utilisateur et lui associé un nombre de points, afin de vérifier si le résultat est bien celui attendu.</p>
<p>Ecrire des tests unitaires permet d’avoir un code modulaire et évolutif qui sépare correctement l’interface de l’implémentation. Le module qui est suffisamment testé peut être réutilisé dans un développement ultérieur.</p>
<h2 id="Avantages-des-tests-unitaires"><a href="#Avantages-des-tests-unitaires" class="headerlink" title="Avantages des tests unitaires"></a>Avantages des tests unitaires</h2><p>Avoir une application avec des tests unitaires permet de livrer en production des versions de votre application fonctionnelle en toute confiance. Par exemple, votre équipe a développé une grosse brique fonctionnelle susceptible d’impacter d’autres fonctionnalités du site. Livrer sur l’environnement de production une telle modification peut être catastrophique. Le passage en revue de tous les tests permettra de s’assurer que cette nouvelle fonctionnalité fonctionne de manière attendu sans détériorer l’existant (on appelle ce cas une <code>régression fonctionnelle</code>).</p>
<p>Rédiger des tests pour chaque fonction nécessite un temps additionnel pour le développeur mais en rédigeant des tests de qualité, cela améliorera intrinsèquement la documentation du code. Un nouvel arrivant pourra se référer aux tests pour comprendre le fonctionnement de telle fonction.</p>
<h2 id="Installation-de-PHPUnit-sur-macOs"><a href="#Installation-de-PHPUnit-sur-macOs" class="headerlink" title="Installation de PHPUnit sur macOs"></a>Installation de PHPUnit sur macOs</h2><ol>
<li><p>Ouvrez votre terminal</p>
</li>
<li><p>Dans ce dernier tapez les commandes suivantes</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ curl https://phar.phpunit.de/phpunit.phar -L -o phpunit.phar</div><div class="line">$ chmod +x phpunit.phar</div><div class="line">$ mv phpunit.phar /usr/local/bin/phpunit</div></pre></td></tr></table></figure>
<p><strong>NB</strong> : Ne pas recopier le symbole dollar ($), il s’agit ici d’une convention d’écriture dans le terminal.</p>
<p>Ces 3 commandes permettent de télécharger <code>phpunit.phar</code>. The <code>chmod</code>command va modifier les droits d’accès du fichier <code>phpunit.phar</code>. Plus précisément cela va donner le droit de lecture et d’exécution du fichier à tous les utilisateurs, les groupes et les autres parties du système.</p>
<p>La commande <code>mv</code>permet quand à elle de changer de place ce fichier, de l’emplacement actuel à l’emplacement <code>/usr/local/bin/phpunit</code></p>
<ol>
<li>Afin de vérifier si l’installation s’est bien déroulée veillez à exécuter cette commande :</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ phpunit -version</div></pre></td></tr></table></figure>
<p>Si l’installation est OK vous devriez voir s’afficher dans votre terminal la ligne suivante :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PHPUnit 5.5.0 by Sebastian Bergmann and contributors.</div></pre></td></tr></table></figure></p>
<p>(La version peut changer)</p>
<h2 id="Configuration-d’un-projet-existant-et-redaction-du-premier-test"><a href="#Configuration-d’un-projet-existant-et-redaction-du-premier-test" class="headerlink" title="Configuration d’un projet existant et rédaction du premier test"></a>Configuration d’un projet existant et rédaction du premier test</h2><ol>
<li>Sur un projet existant la première étape va consister à créer un dossier nommé <code>tests</code> à la racine de votre dossier.</li>
</ol>
<p>Dans ce dernier vous allez placer tous vos tests. La règle étant que pour chaque classe de votre projet (si vous utilisez la POO) un fichier devra être créé.</p>
<p>La convention de nommage que j’utilise personnellement est la suivante :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NomDeVotreClasseTests.php</div></pre></td></tr></table></figure></p>
<p>ou en camel case :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nom_de_la_classe_tests.php</div></pre></td></tr></table></figure></p>
<ol>
<li>Ainsi si vous avez une classe <code>Utilisateur</code> définie au sein du fichier <code>Utilisateur.php</code> vous trouverez en miroir un fichier de test de cette classe nommé <code>UtilisateurTests.php</code></li>
</ol>
<p>Ce fichier aura toujours une composition identique :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//fichier : tests/UtilisateurTests.php</span></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// Réglage de la time zone</span></div><div class="line">date_default_timezone_set(<span class="string">'America/Los_Angeles'</span>);</div><div class="line"><span class="comment">// Si vous utilisez composer (le gestionnaire de package, ajoutez cette ligne)</span></div><div class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> .<span class="string">'/../vendor/autoload.php'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UtilisateurTests</span> <span class="keyword">extends</span> <span class="title">TestCase</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">  <span class="comment">// il s'agit ici de la structure d'un test unitaire pour la méthode</span></div><div class="line">  <span class="comment">// function_number_one de notre Utilisateur</span></div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_function_number_one</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Nous avons donc ici la classe permettant de tester la classe <code>Utilisateur</code>.<br>Cette classe se nomme <code>UtilisateurTests</code> et il s’agit d’une extension de la classe <code>TestCase</code>. Cette dernière est une classe interne à PHPUnit et elle nous permet d’utiliser des méthodes faciles pour écrire nos tests.</p>
<p>Ici un seul test unitaire est définit. En fait un test unitaire est une méthode de la classe de test (<code>UtilisateurTests</code>). Chaque test va donc tester une méthode de notre classe <code>Utilisateur</code>.</p>
<ol>
<li>L’étape suivante consiste à écrire effectivement notre test.</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// fichier : tests/UtilisateurTests.php</span></div><div class="line"><span class="comment">// Réglage de la timezone</span></div><div class="line">date_default_timezone_set(<span class="string">'America/Los_Angeles'</span>);</div><div class="line"><span class="comment">// Si vous utilisez composer (le gestionnaire de package, ajoutez cette ligne)</span></div><div class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> .<span class="string">'/../vendor/autoload.php'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UtilisateurTests</span> <span class="keyword">extends</span> <span class="title">TestCase</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">  <span class="comment">// il s'agit ici de la structure d'un test unitaire pour la méthode</span></div><div class="line">  <span class="comment">// function_number_one de notre Utilisateur</span></div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test_function_number_one</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// instanciation de notre classe Utilisateur</span></div><div class="line">    $instance_utilisateur = <span class="keyword">new</span> Utilisateur();</div><div class="line">    <span class="comment">// execution de la méthode à tester</span></div><div class="line">    $resultat_function_number_one = $instance_utilisateur -&gt; function_number_one(<span class="number">123</span>);</div><div class="line">    <span class="comment">// TEST du résultat attendu</span></div><div class="line">    <span class="keyword">$this</span>-&gt;assertEquals(<span class="string">"resultat attendu"</span>, $resultat_function_number_one);</div><div class="line"></div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Le cas de test consiste simplement à lancer la méthode function_number_one avec le paramètre 123.<br>Nous allons ensuite tester si le résultat d’exécution de cette méthode est bien égale au résultat attendu grâce à la ligne <code>$this-&gt;assertEquals(&quot;resultat attendu&quot;, $resultat_function_number_one);</code></p>
<ol>
<li>Exécuter le test</li>
</ol>
<p>Afin de lancer votre test il suffit d’ouvrir votre terminal et de taper :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd le_dossier_contenant_votre_application</div><div class="line">$ phpunit tests</div></pre></td></tr></table></figure></p>
<p>La commande numéro 2 va dire à PHPUnit de lancer l’exécution des tests définit dans le dossier <code>tests</code></p>
<p>Et voilà ! Bon tests</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/23/Comment-installer-PHPUnit-sur-macOs-sur-un-projet-PHP-existant-et-ecrire-un-test/" data-id="civ0u11o1000dhcmik4hqiv6p" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/23/Comment-installer-PHPUnit-sur-macOs-sur-un-projet-PHP-existant-et-ecrire-un-test/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP-Tests-unitaires/">PHP ; Tests unitaires</a></li></ul>


    </footer>
  </div>
  
</article>



  
    <article id="post-Pourquoi-et-comment-creer-un-module-avec-nodejs" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/23/Pourquoi-et-comment-creer-un-module-avec-nodejs/">Pourquoi et comment créer des modules sur NodeJs</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2016/09/23/Pourquoi-et-comment-creer-un-module-avec-nodejs/" class="article-date"><time datetime="2016-09-22T22:34:20.000Z" itemprop="datePublished">23/09/2016</time></a>
</div>

    
    

  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Qu’est-ce-qu’un-module"><a href="#Qu’est-ce-qu’un-module" class="headerlink" title="Qu’est ce qu’un module ?"></a>Qu’est ce qu’un module ?</h2><p>Un module est une partie d’un programme informatique développé par le programmeur afin d’effectuer une série de <strong>tâches</strong> précises. Chaque module contient en général plusieurs fonctionnalités. On croise aussi l’appellation <code>package</code> qui recouvre exactement la même notion : une brique de fonctionnalité que l’on peut utiliser et réutiliser dans n’importe quel projet.</p>
<p>La notion de développement par module (ou modulaire) est née dans les années 1960 lors de l’émergence du paradigme de la <code>programmation orientée objet</code> et la création de langages plus structurés qui pouvait en faire l’usage.</p>
<p>On pourrait imaginer <strong>par exemple</strong> un module dont le but serait d’envoyer un email de bienvenue à nos nouveaux inscrits. Ce dernier pourrait être utilisé à nouveau dans tous les programmes suivants que nous allons créer qui nécessiteront un email de bienvenue.</p>
<p>Vous ne saisissez peut-être pas immédiatement l’intérêt de créer des modules sur nodejs, car lorsqu’on débute il est plus facile d’écrire directement le bout de code qui permet l’envoi de l’email de bienvenue directement après l’enregistrement du visiteur. Mais au rythme des développements on se fait souvent la réflexion que l’on a au final déjà écrit ce bout de code plusieurs fois… D’où l’intérêt de <strong>modulariser</strong> son développement.</p>
<h2 id="Pourquoi-ecrire-des-modules"><a href="#Pourquoi-ecrire-des-modules" class="headerlink" title="Pourquoi écrire des modules"></a>Pourquoi écrire des modules</h2><p>Le développement modulaire permet de <strong>diviser</strong> un projet extrêmement complexe en micros brique fonctionnelles très simples rendant le travail du développeur moins titanesque et plus facilement quantifiable.</p>
<p>Prenons un exemple : bâtir un site e-Commerce. Il s’agit d’un projet d’envergure mais au final le site e-Commerce n’est que l’addition de fonctionnalités simples : sauvegarde et mise à jour des produits dans une base de données, gestion de la connexion des utilisateurs, envoie des emails de confirmations… En pensant le projet de façon modulaire <strong>on peut aussi se servir dans l’incroyable bibliothèque open source disponible</strong>. En particulier sur Nodejs où les modules sont nombreux et tous regroupés au sein de npm. (<a href="https://www.npmjs.com/" target="_blank" rel="external">https://www.npmjs.com/</a>)</p>
<p>Le développement par module permet aussi une <strong>meilleure couverture</strong> du code via des tests unitaires. Ce n’est probablement pas le focus de nombre de développeurs lors de l’initialisation d’un projet, mais plus le nombre de contributeurs augmentent et plus la base de code augmente plus chaque mise en production sans suite de <strong>tests unitaires</strong> assurera des sueurs froides à l’équipe.</p>
<p>Le développement modulaire permet aussi de casser la fameuse <strong>loi de Brooks</strong>, qui assure qu’ajouter des développeurs à un projet subissant du retard ne fait qu’aggraver ce dernier. Mais pourquoi ça ? En raison du fait qu’un code modulaire est plus compréhensible et donc que les nouveaux arrivants sur le projet n’ont pas autant besoin de formations de leurs pairs pour être opérationnels.</p>
<h2 id="Creer-son-propre-module-en-Nodejs"><a href="#Creer-son-propre-module-en-Nodejs" class="headerlink" title="Créer son propre module en Nodejs"></a>Créer son propre module en Nodejs</h2><ol>
<li>Dans le dossier de votre programme <strong>créez un dossier que vous nommerez de la même manière que votre module</strong>.</li>
</ol>
<p>Concernant le nommage une règle est de mise : il est conseiller d’être le plus explicite possible et d’appeler son module suivant sa tâche principal. Nous allons ici écrire un module qui permettant de vérifier qu’une chaine de caractère est bien un email au bon format. Nous pouvons donc appeler notre module <code>email_checker</code> par exemple.</p>
<ol>
<li><p>Dans ce dossier vous allez créer un fichier nommé <code>index.js</code> qui va contenir le code de notre module.</p>
</li>
<li><p>Dans ce fichier <code>index.js</code>, localisé dans <code>/mon_projet/email_checker/index.js</code> nous allons définir une fonctionnalité (ce sera donc une fonction) permettant d’effectuer notre tâche : vérifier si une chaine de caractère est bien un email.</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  fichier : index.js</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> check_that_email= <span class="function"><span class="keyword">function</span>(<span class="params">email_to_check</span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// définition d'une expression régulière matchant les emails</span></div><div class="line">  <span class="keyword">var</span> regex = <span class="regexp">/^(([^&lt;&gt;()\[\]\\.,;:\s@"]+(\.[^&lt;&gt;()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]&#123;2,&#125;))$/</span>;</div><div class="line"></div><div class="line">  <span class="comment">// on retourne le test de notre chaine de caractère (email_to_check)</span></div><div class="line">    <span class="keyword">return</span> regex.test(email_to_check);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Notez ici la construction étrage de notre module. Nous avons en fait défnit une variable nommée <code>check_that_email</code> qui contient une fonction.</p>
<p>Cette syntaxe est très courante et il vaut mieux vous y faire, mais elle est troublantes je vous l’accorde. Reste qu’on peut bien mettre une fonction dans une variable !</p>
<ol>
<li>Il suffit maintenant d’exposer cette fonction afin de pouvoir l’utiliser dans notre programme. Pour cela nous allons utiliser la syntaxe d’exportation propre à nodejs.</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  fichier : index.js</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//....</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">check_that_email</span>: check_that_email</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Dans ce morceau de code nous exportons notre fonction <code>check_that_email</code> sous le nom externe <code>check_that_email</code> afin de pouvoir nous en servir par ailleurs.<br>On aurait pu l’appeler autrement :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//  fichier : index.js</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//....</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">can_you_check_that_email_please</span>: check_that_email</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Le nom public de cette fonction (ou méthode) sera maintenant <code>can_you_check_that_email_please</code> !</p>
<p>Votre module est fini ! Bravo. Utilisons le maintenant.</p>
<h2 id="Utilisation-de-notre-module"><a href="#Utilisation-de-notre-module" class="headerlink" title="Utilisation de notre module"></a>Utilisation de notre module</h2><p>Dans n’importe quel script de notre application nous pouvons appeler notre module ainsi :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> email_checker = <span class="built_in">require</span>(<span class="string">"chemin/vers/le/dossier/email_checker"</span>);</div></pre></td></tr></table></figure>
<p>Et nous pouvons appeler une méthode ainsi<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> result_of_email_checking = email_checker.check_that_email(<span class="string">"john.doe@gmail.com"</span>);</div></pre></td></tr></table></figure></p>
<p>Easy !</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://maximilienandile.github.io/2016/09/23/Pourquoi-et-comment-creer-un-module-avec-nodejs/" data-id="civ0u11o6000jhcmind1p3ge4" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
        <a href="http://maximilienandile.github.io/2016/09/23/Pourquoi-et-comment-creer-un-module-avec-nodejs/#disqus_thread" class="article-comment-link">
          <i class="fa fa-comment"></i> Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/">nodejs</a></li></ul>


    </footer>
  </div>
  
</article>



  


  <div id="page-nav">
    <nav><ul class="pagination"><li class="disabled"><span class="page-prev"><i class="fa fa-chevron-left"></i> Prev</a></li><li class="active"><span class="page-number">1</span></li><li><a class="page-number" href="/page/2/">2</a></li><li><a class="page-next" rel="next" href="/page/2/">Next <i class="fa fa-chevron-right"></i></a></li></ul></nav>
  </div>



        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  <div class="sidebar-module sidebar-module-inset">
  <h4>About</h4>
  <p>I am Maximilien Andile a Tech enthusiast and teacher who is always happy to share knowledge</p>

</div>


  


  
  <div class="sidebar-module">
    <h4>Tags</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/Business-Intelligence/">Business Intelligence</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/HTTP/">HTTP</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/Machine-Learning/">Machine Learning</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/NLP/">NLP</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/Natural-Language-Processing/">Natural Language Processing</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/Nodejs/">Nodejs</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/PHP/">PHP</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/PHP-Tests-unitaires/">PHP ; Tests unitaires</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/REST/">REST</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/SQL/">SQL</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/tags/nodejs/">nodejs</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Tag Cloud</h4>
    <p class="tagcloud">
      <a href="/tags/Business-Intelligence/" style="font-size: 10px;">Business Intelligence</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Machine-Learning/" style="font-size: 20px;">Machine Learning</a> <a href="/tags/NLP/" style="font-size: 20px;">NLP</a> <a href="/tags/Natural-Language-Processing/" style="font-size: 10px;">Natural Language Processing</a> <a href="/tags/Nodejs/" style="font-size: 10px;">Nodejs</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/PHP-Tests-unitaires/" style="font-size: 10px;">PHP ; Tests unitaires</a> <a href="/tags/REST/" style="font-size: 10px;">REST</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a>
    </p>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/11/">novembre 2016</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/10/">octobre 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/09/">septembre 2016</a><span class="sidebar-module-list-count">6</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/06/">juin 2016</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/05/">mai 2016</a><span class="sidebar-module-list-count">3</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/2016/11/02/Comment-creer-un-script-shell-permettant-de-recuperer-et-d-analyser-des-articles-wikipedia-avec-lynx/">Comment créer un script shell permettant de récupérer et d&#39;analyser des articles wikipedia avec lynx</a>
        </li>
      
        <li>
          <a href="/2016/10/17/Machine-Learning-classification-a-l-aide-des-arbres-de-decisions-fonctionnement-et-application-en-NodeJS/">Machine Learning : classification à l&#39;aide des arbres de décisions : fonctionnement et application en NodeJS</a>
        </li>
      
        <li>
          <a href="/2016/10/12/Base-de-donnees-comprendre-les-differences-entre-le-modele-relationnel-et-le-modele-multidimensionnel/">Base de données : comprendre les différences entre le modèle relationnel et le modèle multidimensionnel</a>
        </li>
      
        <li>
          <a href="/2016/10/01/Comment-installer-PHPUnit-sur-un-projet-necessitant-composer-et-utilisant-des-variables-d-environnement/">Comment installer PHPUnit sur un projet nécessitant composer et utilisant des variables d&#39;environnement</a>
        </li>
      
        <li>
          <a href="/2016/09/30/Comprendre-les-headers-d-une-requete-HTTP/">Comprendre les headers d&#39;une requête HTTP</a>
        </li>
      
    </ul>
  </div>



        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2016 Maximilien Andile<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  
<script>
  var disqus_shortname = 'maximilienandile';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>



<script src="/js/script.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
